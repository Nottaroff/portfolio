---
title: Diario de Registro  üìù
layout: default
has_toc: false
nav_order: 1
parent: 100 days challenge üóª
---

{: .work }
>En este apartado se registra el progreso d√≠a a d√≠a del reto

---
<details>
  <summary><strong>Day 1: Introducci√≥n al Threat Hunting.</strong></summary>
    <body>
        <p>El d√≠a de hoy he dedicado a la b√∫squeda de informaci√≥n general sobre el tema, que es el threat hunting y porque es importante a d√≠a de hoy en la ciberseguridad. Tambi√©n he realizado la sala de TryHackme de Threat Hunting: Introduction.</p>
        
        <p>Peque√±o extracto:</p>
        <p>El Threat Hunting consiste en la b√∫squeda proactiva y sistem√°tica de posibles amenazas o actividades maliciosas dentro de una red o sistema inform√°tico que a√∫n no han sido detectadas.</p>

        <p>Si dependemos solamente de las herramientas de seguridad para detectar un ataque, como el incident response (IR). La acci√≥n frente a la amenaza se desencadena por una alerta del sistema. Esto conlleva un proceso de triaje y an√°lisis, y cuando se determina de que se trata de una actividad maliciosa, debe ser respondida y tratada en consecuencia. Si el sistema no fuera capaz de detectar el ataque no habr√≠a ninguna respuesta a √©l. Por ello, es necesario el Threat Hunting ya que es una metodolog√≠a proactiva, en b√∫squeda constante de nuevas amenazas. No hay una alerta real que d√© inicio a la b√∫squeda, excepto el objetivo de fortalecer la postura de seguridad de la organizaci√≥n.</p>

        <p>Generalmente, las organizaciones comienzan a realizar el threat hunting una vez que ya tienen establecido un proceso de incident response , pero puede que algunos incidentes no se est√°n detectando lo suficientemente temprano. El objetivo principal del threat hunting es lograr una detecci√≥n temprana de estas amenazas.</p>

        <h2>REFERENCIAS</h2>
        <ul>
            <li><a href="https://www.crowdstrike.com/cybersecurity-101/threat-hunting/">CrowdStrike Threat Hunting</a></li>
            <li><a href="https://www.ibm.com/topics/threat-hunting">IBM Threat Hunting</a></li>
            <li><a href="https://www.threathunting.net/files/hunt-evil-practical-guide-threat-hunting.pdf">Gu√≠a pr√°ctica de caza de amenazas (PDF)</a></li>
            <li><a href="https://tryhackme.com/r/room/introductiontothreathunting">Introduction to Threat Hunting en TryHackMe</a></li>
        </ul>
    </body>
</details>

<details>
  <summary><strong>Day 2: Tipos y Metodolog√≠as</strong></summary>
  
  <p>Despu√©s de la b√∫squeda de informaci√≥n general he acabado de definir el indicie de este periodo de Introducci√≥n. Mi idea es cuando vaya terminando los temas subir√© el contenido detallado a una p√°gina de GitHub. As√≠ si a alguien le interesa el tema, puede mirar m√°s en detalle mi recopilaci√≥n.</p>

  <h3>Resumen del d√≠a de hoy:</h3>
  <p>Dentro del threat hunting podemos distinguir diferentes tipos y m√©todos:</p>

  <h4>1.2 Tipos</h4>
  <p>Existen diferentes enfoques que pueden tomar los equipos de ciberseguridad en cuanto al threat hunting. En este sentido, se pueden identificar distintos tipos de caza de amenazas, con sus propias metodolog√≠as y procesos espec√≠ficos. Podemos distinguir entre tres tipos de threat hunting:</p>
  <ul>
    <li>Estructurado</li>
    <li>No estructurada</li>
    <li>Situacional</li>
  </ul>

  <h4>1.3 Metodolog√≠as</h4>
  <p>Dentro de cada tipo de caza de amenazas, las metodolog√≠as proporcionan un marco detallado para la ejecuci√≥n pr√°ctica de la detecci√≥n y respuesta a amenazas. Estas metodolog√≠as establecen los pasos espec√≠ficos que los equipos de ciberseguridad deben seguir para identificar, investigar y neutralizar posibles riesgos. Las principales metodolog√≠as son:</p>
  <ul>
    <li>Investigaci√≥n impulsada por hip√≥tesis (Hypothesis hunting)</li>
    <li>Investigaci√≥n basada en indicadores conocidos de compromiso o indicadores de ataque (IoA) (Intel-based hunting)</li>
    <li>Investigaciones situacionales o avanzadas de an√°lisis y aprendizaje autom√°tico (Custom hunting)</li>
  </ul>

  <strong>REFERENCIAS:</strong>
  <ul>
    <li><a href="https://livebook.manning.com/book/cyber-threat-hunting/chapter-1/v-10/1">Manual general</a></li>
    <li><a href="https://cybertalents.com/blog/threat-hunting">Tipos/m√©todos</a></li>
  </ul>
</details>


<details>
  <summary><strong> Day 3: Importancia y Etapas</strong></summary>
  
  <p>Continuando con la Introducci√≥n al Threat Hunting, el d√≠a de hoy he definido la importancia de establecer el threat hunting como m√©todo defensivo, las posibles etapas a la hora de desarollar la caza de amenazas y he incluido algunos t√©rminos relativos al threat hunting en el glosario.</p>

  <h3>Extracto resumido de la informaci√≥n recopilada:</h3>

  <h4>1.4 Importancia del Threat Hunting</h4>
  <p>La principal diferencia de las medidas de seguridad tradicionales que se centran en la prevenci√≥n y detecci√≥n automatizada, el Threat Hunting implica una investigaci√≥n activa por parte de un analista. Dicha investigaci√≥n nos dar√° proactividad en nuestro sistema de b√∫squeda de amenazas.</p>
  <p>La importancia del threat hunting consiste en:</p>
  <ul>
    <li>Nos permite la identificaci√≥n de amenazas avanzadas.</li>
    <li>Reducci√≥n del tiempo de respuesta.</li>
    <li>Mejora de la postura de seguridad inform√°tica.</li>
    <li>Adaptaci√≥n a las nuevas amenazas.</li>
  </ul>
  <p>Actualmente, el Threat Hunting se ha convertido en una herramienta fundamental en el arsenal de cualquier equipo ciberseguridad. Su evoluci√≥n ha sido impulsada por la necesidad de combatir amenazas cada vez m√°s sofisticadas, aprovechando tecnolog√≠as avanzadas y adoptando un enfoque proactivo basado en el comportamiento.</p>

  <h4>1.5 Etapas</h4>
  <p>Podemos estructurar el threat hunting mediante una serie de fases durante su desarrollo. Estas etapas nos ayudan a establecer una estructura clara y efectiva para llevar a cabo la actividad de caza de amenazas.</p>
  <ul>
    <li>Generaci√≥n de hip√≥tesis</li>
    <li>Investigaci√≥n</li>
    <li>Descubrimiento de patrones</li>
    <li>An√°lisis automatizado</li>
  </ul>

  <strong>REFERENCIAS</strong>
  <ul>
    <li><a href="https://www.cybereason.com/fundamentals/what-is-threat-hunting">¬øQu√© es la caza de amenazas? - Cybereason</a></li>
    <li><a href="https://es.darktrace.com/cyber-ai-glossary/threat-hunting">Glosario de ciberinteligencia: Caza de amenazas - Darktrace</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 4: Glosario, Publicaci√≥n y Revisi√≥n</strong></summary>
  
  <p>El d√≠a de hoy doy por concluida la primera etapa de introducci√≥n al Threat Hunting. Hemos visto que es, que tipos hay, metodolog√≠as, etapas y la importancia que tiene hacer threat hunting para mejorar nuestra protecci√≥n ante las amenazas. Me he dedicado a revisar la informaci√≥n que he podido detallar de los puntos mencionados y los he publicado en mi GitHub.</p>
  <p>Pod√©is ver el art√≠culo publicado de introducci√≥n <a href="https://nottaroff.github.io/workspace/docs/100%20days/Introduccion/">aqu√≠</a>.</p>
  <p>Tambi√©n he a√±adido algunos t√©rminos en el glosario, sobre todo los mencionados en la introducci√≥n. Este apartado lo ir√© trabajando a lo largo del reto.</p>
  <p>He creado unos gr√°ficos para representar un poco mejor los conceptos vistos en la introducci√≥n.</p>

  <p><strong>Glosario a√±adido:</strong> <a href="https://nottaroff.github.io/workspace/docs/100%20days/Introduccion/#15-glosario">aqu√≠</a></p>
  <ul>
    <li>IoA (Indicador de Ataque)</li>
    <li>TTP (T√°cticas, T√©cnicas y Procedimientos)</li>
    <li>MITRE</li>
    <li>IoC (Indicador de Compromiso)</li>
    <li>STIX (Structured Threat Information eXpression)</li>
    <li>TAXII (Trusted Automated eXchange of Indicator Information)</li>
    <li>SIEM (Security Information and Event Management)</li>
    <li>EDR (Endpoint Detection and Response)</li>
    <li>CERT (Computer Emergency Response Team)</li>
  </ul>

  <strong>REFERENCIAS:</strong>
  <ul>
    <li><a href="https://nottaroff.github.io/workspace/docs/100%20days/">100 Days - Documentaci√≥n</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 5: Recopilaci√≥n y an√°lisis de informaci√≥n sobre amenazas</strong></summary>
  
  <p>Continuando con la fase del pre-hunting. El d√≠a de hoy he estado document√°ndome sobre la recopilaci√≥n y an√°lisis en el threat hunting. Sobre qu√© tener en cuenta a nivel te√≥rico.</p>

  <h3>Recopilaci√≥n y an√°lisis de informaci√≥n sobre amenazas</h3>

  <h4>2.1 Fuentes de inteligencia de amenazas.</h4>
  <p>Las fuentes de inteligencia de amenazas son cruciales para una caza efectiva de amenazas, proporcionando informaci√≥n esencial para detectar y contrarrestar los riesgos de seguridad de manera eficaz.</p>
  <p>Algunas fuentes comunes:</p>
  <ul>
    <li>Informes de seguridad.</li>
    <li>Comunidades de seguridad y foros en l√≠nea.</li>
    <li>Informaci√≥n compartida por organizaciones.</li>
    <li>Resultados de investigaciones forenses de incidentes previos.</li>
    <li>Datos internos generados por herramientas de monitoreo de seguridad y an√°lisis de registros.</li>
  </ul>

  <h4>2.2 T√©cnicas para recopilar informaci√≥n.</h4>
  <p>Aunque el enfoque principal del Threat Hunting es el ser humano, contar con acceso a tecnolog√≠as relevantes y confiables, as√≠ como a herramientas escalables y flexibles:</p>
  <ul>
    <li>Actividades de endpoints en servidores y clientes.</li>
    <li>Datastores.</li>
    <li>An√°lisis.</li>
  </ul>

  <h4>2.3 M√©todos anal√≠ticos.</h4>
  <p>Los enfoques anal√≠ticos son necesarios para extraer informaci√≥n valiosa de los datos recopilados.</p>
  <p>Algunas t√©cnicas comunes son:</p>
  <ul>
    <li>Evaluaci√≥n de comportamiento.</li>
    <li>Correlaci√≥n de datos.</li>
    <li>Identificaci√≥n de firmas.</li>
    <li>An√°lisis de riesgo.</li>
    <li>Seguimiento de tendencias.</li>
  </ul>

  <h4>2.4 Gesti√≥n de datos. (WIP)</h4>
  <p>He incluido este apartado de gesti√≥n de datos desde una perspectiva del threat hunter para entender c√≥mo se documentan, se estandarizan, se modelan y la calidad de los datos. Es muy importante comprender bien estos pasos al desarrollar una anal√≠tica.</p>

  <strong>REFERENCIAS:</strong>
  <ul>
    <li><a href="https://www.ibm.com/es-es/topics/threat-intelligence">IBM Threat Intelligence</a></li>
    <li><a href="https://openaccess.uoc.edu/bitstream/10609/107546/6/aveloymTFM1219memoria.pdf">Memoria: Threat hunting en entornos Windows</a></li>
    <li><a href="https://github.com/OTRF/OSSEM">OSSEM en GitHub</a></li>
  </ul>
</details>


<details>
  <summary><strong>Day 6: Gesti√≥n de Datos</strong></summary>
  
  <p>Continuando con el punto 2. Recopilaci√≥n y an√°lisis de informaci√≥n sobre amenazas.</p>
  <p>He estado investigando c√≥mo se gestionan los datos y por qu√© es importante desde un punto de vista anal√≠tico. La teor√≠a en este tema es l√≥gica y comprensible, pero al observar ejemplos dentro de un sistema, no era tan f√°cil de entenderlo desde mi perspectiva. Por lo tanto, encontr√© algunas salas de TryHackMe que me ayudaron a comprender mejor el funcionamiento interno de la gesti√≥n de datos.</p>
  <p>El d√≠a de hoy he realizado la room: <a href="https://tryhackme.com/r/room/windowseventlogs">https://tryhackme.com/r/room/windowseventlogs</a> que me ha proporcionado diferentes herramientas en Windows para poder buscar, localizar y extraer informaci√≥n de los logs del sistema.</p>

  <h4>Extracto de la parte te√≥rica:</h4>

  <p><strong>Documentaci√≥n de Datos</strong></p>
  <p>Para realizar el an√°lisis y la interpretaci√≥n de los datos, es fundamental comprender qu√© datos se est√°n recopilando y c√≥mo se est√°n estructurando.</p>

  <p><strong>Estandarizaci√≥n de Datos</strong></p>
  <p>La estandarizaci√≥n de datos nos ofrece una coherencia y eficacia en el an√°lisis de la informaci√≥n recopilada de diversas fuentes. Se basa en el empleo de un Modelo de Informaci√≥n Com√∫n (CIM), que proporciona una estructura para normalizar conjuntos de datos mediante un esquema.</p>

  <p><strong>Modelaci√≥n de Datos (Data Modeling)</strong></p>
  <p>El modelo de datos determina la estructura de los datos y las relaciones entre ellos. Identificar estas relaciones es importante para documentar eventos espec√≠ficos que podr√≠an vincularse a cadenas de eventos relacionadas con el comportamiento de los adversarios.</p>

  <p><strong>Calidad de Datos (Data Quality)</strong></p>
  <p>La calidad de los datos se refiere a su valor para los usos previstos en las operaciones, toma de decisiones y planificaci√≥n.</p>

  <strong>REFERENCIAS:</strong>
  <ul>
    <li><a href="https://www.ibm.com/docs/es/flashsystem-a9000/12.2.1?topic=STJKMM_12.2.1/xiv_apicimconcepts.htm">Conceptos de CIM para FlashSystem</a></li>
    <li><a href="https://opennetworking.org/wp-content/uploads/2014/10/TR-513_CIM_Overview_1.2.pdf">Visi√≥n general de CIM por Open Networking Foundation</a></li>
    <li><a href="https://threathunterplaybook.com/pre-hunt/data_management.html">Data Management en Threat Hunter Playbook</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 7: T√©cnicas y herramientas del Threat Hunting</strong></summary>
  
  <p>En el d√≠a de hoy, he terminado la secci√≥n anterior de Recopilaci√≥n y an√°lisis, pod√©is consultar el art√≠culo completo en mi blog: <a href="https://nottaroff.github.io/workspace/docs/100%20days/2.%20Recopilacion/">aqu√≠</a>.</p>
  <p>El siguiente apartado se trata de T√©cnicas y herramientas. He definido algunas t√©cnicas comunes y al profundizar en las herramientas, he detallado el modelo de madurez de caza. Es un gr√°fico que le sirve a los entornos organizacionales para decir en qu√© punto del threat hunting est√°n. Creo que es interesante conocerlo para saber qu√© tipo de herramientas habr√° que utilizar. Art√≠culo completo: <a href="https://nottaroff.github.io/workspace/docs/100%20days/3.%20Tecnicas%20y%20Herramientas/">aqu√≠</a>.</p>
  <p>Con esta secci√≥n doy por concluidos los primeros 7 d√≠as del challenge, que han sido m√°s te√≥rico introductorios. Durante los pr√≥ximos d√≠as intentar√© sumergirme en temas m√°s pr√°cticos del threat hunting.</p>

  <strong>REFERENCIAS:</strong>
  <ul>
    <li><a href="https://socprime.com/blog/threat-hunting-maturity-model-explained-with-examples/">Threat Hunting Maturity Model Explained with Examples</a></li>
    <li><a href="https://heimdalsecurity.com/blog/threat-hunting-techniques/">Threat Hunting Techniques</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 8: Elastic Introduction</strong></summary>
  
  <p>Hoy he realizado varios ejercicios pr√°cticos de iniciaci√≥n al threat hunting. Para ello, complet√© varias rooms en TryHackMe.</p>

  <p>En primer lugar, me familiaric√© con Elastic Stack en la siguiente room: <a href="https://tryhackme.com/r/room/investigatingwithelk101">Investigating with ELK 101</a>. Es una plataforma de c√≥digo abierto que combina varios componentes para la b√∫squeda, an√°lisis y visualizaci√≥n de datos. Aprend√≠ a realizar b√∫squedas, aplicar filtros, guardar b√∫squedas, crear visualizaciones e investigar registros de VPN para identificar anomal√≠as. Tambi√©n aprend√≠ a utilizar tableros con b√∫squedas guardadas y visualizaciones.</p>

  <p>La segunda parte de esta experiencia fue en la room <a href="https://tryhackme.com/r/room/advancedelkqueries">Advanced ELK Queries</a>. Aqu√≠ explor√© diferentes tipos de consultas avanzadas y las diversas sintaxis de consulta, incluyendo KQL y Lucene.</p>

  <p>Por √∫ltimo, despu√©s de la introducci√≥n a Elastic Stack, comenc√© la room pr√°ctica sobre aplicaci√≥n al threat hunting: <a href="https://tryhackme.com/r/room/threathuntingfoothold">Threat Hunting Foothold</a>. Empec√© por el primer apartado sobre Acceso Inicial, donde investigu√© las t√©cnicas que los adversarios utilizan para ingresar a una organizaci√≥n.</p>

  <p>El d√≠a de hoy he realizado varios ejercicios pr√°cticos de iniciaci√≥n al threat hunting. Para ello, he realizado varias rooms de TryHackMe.</p>
</details>

<details>
  <summary><strong>Day 9: Threat Hunting Foothold</strong></summary>
  
  <p>El d√≠a de hoy realic√© la room de: <a href="https://tryhackme.com/r/room/threathuntingfoothold">Threat Hunting Foothold</a>.</p>
  <p>Es una buena gu√≠a pr√°ctica para aprender c√≥mo detectar actividad maliciosa con Elastic. En ella se tratan varios ejemplos de diferentes actividades maliciosas:</p>

  <h4>Initial Access</h4>
  <p>Detecci√≥n de t√°cticas que los adversarios usan para ingresar a sistemas, como phishing, explotaci√≥n de servidores, fuerza bruta...</p>

  <h4>Execution</h4>
  <p>Se detallan los m√©todos para ejecutar c√≥digo malicioso: herramientas de l√≠nea de comandos, herramientas del sistemas integradas (certutil.exe o bitsadmin.exe), scripting.</p>

  <h4>Defense Evasion</h4>
  <p>Detecci√≥n de t√°cticas para evitar la detecci√≥n por parte de sistemas de seguridad, como desactivaci√≥n de software de seguridad, eliminaci√≥n de registros, bypasses.</p>

  <h4>Persistence</h4>
  <p>Detecci√≥n de t√©cnicas para mantener el acceso a redes comprometidas a largo plazo, como modificaci√≥n de claves de registro, scripts de auto-start, creaci√≥n de usuarios.</p>

  <h4>Command and Control</h4>
  <p>Detecci√≥n de m√©todos de comunicaci√≥n de los adversarios con sistemas comprometidos, Comand and control techniques, servicios basados en la nube, servidores https cifrados y protocolos de red.</p>
</details>

<details>
  <summary><strong>Day 10: Threat Hunting Pivoting</strong></summary>
  
  <p>Siguiendo la l√≠nea de aprendizaje sobre el hunting, hoy he profundizado en la detecci√≥n de dos t√©cnicas m√°s a trav√©s de Elastic.</p>

  <h4>Discovery</h4>
  <p>Referente a las acciones que un atacante puede tomar para comprender mejor los sistemas y redes que han infiltrado. Detecci√≥n de actividades como:</p>
  <ul>
    <li>Reconocimiento de Usuario: whoami, net,user, net localgroup or qwinsta (Enumeraci√≥n de cuentas) / dir o ls (enumeraci√≥n de directorios).</li>
    <li>Reconocimiento de Host: hostname, wmic, ipconfig o systeminfo (Host) / net start o sc.exe query (Servicios).</li>
    <li>Escaneo Interno: tablas arp, ping, escaneo de puertos (nmap o Powershell).</li>
    <li>Reconocimiento Interno del Dominio: net * /domain o nltest /dclist (Listado de domain users).</li>
  </ul>

  <h4>Escalada de Privilegios</h4>
  <p>T√©cnicas que permiten a un atacante obtener privilegios o permisos m√°s elevados en un sistema o red.</p>
  <ul>
    <li>Explotaci√≥n de vulnerabilidades: uso de exploits.</li>
    <li>Uso de cuentas v√°lidas: Usar runas con credenciales reci√©n descubiertas.</li>
    <li>Abuso de control de acceso: Abuso de ACL, otorgando permisos a otras cuentas.</li>
    <li>Abuso de configuraci√≥n incorrecta del hosts: Configuraciones inseguras; servicios modificables y reiniciables o binarios sobrescribibles.</li>
  </ul>
</details>

<details>
  <summary><strong>Day 11: Threat Hunting Pivoting II</strong></summary>
  
  <p>Continuando con la tarea de entender diferentes t√°cticas maliciosas que debemos tener en cuenta/encontrar como Threat Hunters, el d√≠a de hoy he profundizado en las dos √∫ltimas:</p>

  <h4>Credential Access</h4>
  <p>Se basa en los m√©todos de los atacantes para robar o descubrir nombres de usuario y contrase√±as (o hashes) de cuentas v√°lidas. Es un punto cr√≠tico del sistema ya que permite escalar privilegios o ganar acceso a otros sistemas o recursos de red. Actividades como:</p>
  <ul>
    <li>Credenciales en disco o memoria: Volcar LSASS mediante Mimikatz o creaci√≥n de archivos de volcado de LSASS, listar informaci√≥n de cuentas en el Registro de Windows (reg.exe save hklm\sam), o extraer credenciales DPAPI con SharpDPAPI.</li>
    <li>Credenciales en archivos: Recopilar credenciales en archivos usando findstr /s/n/m/i password, encontrar archivos de administrador de credenciales (Keepass o claves SSH), y volcar credenciales de navegadores mediante SharpChrome o Firefox Decrypt.</li>
    <li>Credenciales de Dominio: Volcar credenciales de dominio mediante DCSync o acceder a credenciales de Administrador Local de LAPS.</li>
    <li>Credential spraying: Intentos fallidos de inicio de sesi√≥n de diversas cuentas en una √∫nica estaci√≥n de trabajo.</li>
  </ul>

  <h4>Movimiento Lateral</h4>
  <p>T√©cnicas de un atacante para navegar por una red, aprovechando las credenciales y sesiones obtenidas durante fases de ataque previas.</p>
  <ul>
    <li>Explotaci√≥n de servicios internos: Atacar servidores internos con aplicaciones/servicios vulnerables.</li>
    <li>Uso de herramientas administrativas leg√≠timas: Emplear herramientas como PsExec, PowerShell remoto, etc.</li>
    <li>Autenticaci√≥n con credenciales v√°lidas: Utilizar contrase√±as en texto plano o t√©cnicas como Pass-the-Hash.</li>
    <li>Acceso a informaci√≥n sensible: Ingresar a servidores de archivos, bases de datos y almacenamiento en la nube.</li>
  </ul>
</details>

<details>
  <summary><strong>Day 12: Threat Hunting in Network</strong></summary>
  
  <p>Despu√©s de ver algunos ejemplos gen√©ricos de detecci√≥n de amenazas, voy a ver c√≥mo detectar las diferentes amenazas seg√∫n el entorno en el que est√©n. El d√≠a de hoy he estado investigando acerca de las amenazas en el entorno de red.</p>

  <h4>Caza de amenazas en Redes</h4>
  <p>Implica el uso de herramientas y m√©todos para monitorear y analizar activamente:</p>
  <ul>
    <li>Tr√°fico de red</li>
    <li>Comportamientos del usuario</li>
    <li>Actividades del sistema</li>
  </ul>

  <h4>T√©cnicas de an√°lisis de tr√°fico de red</h4>
  <p>Examinar el flujo de datos en red para detectar patrones, anomal√≠as y amenazas:</p>
  <ul>
    <li>Inspecci√≥n de Paquetes</li>
    <li>An√°lisis de Tr√°fico</li>
    <li>An√°lisis de Protocolos</li>
    <li>An√°lisis de Comportamiento</li>
  </ul>

  <p>Para la detecci√≥n y mitigaci√≥n de posibles amenazas y vulnerabilidades dentro de una infraestructura de red.</p>

  <h4>Recursos</h4>
  <ul>
    <li><a href="https://shorturl.at/GHMSW">TH Workshop</a></li>
    <li><a href="https://shorturl.at/ovVY0">Threat Intelligence and Data-Driven Threat Hunting</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 13: Network Threat Hunting</strong></summary>
  
  <p>El d√≠a de hoy he seguido profundizando cu√°les son los puntos de referencia durante la caza de amenazas en redes y en detalle la caza de anomal√≠as del DNS.</p>

  <h4>Puntos de referencia durante la caza de amenazas en redes</h4>
  <p>Debemos entender primero qu√© es normal en el entorno de red para luego poder detectar anomal√≠as. Para ello debemos tener en cuenta:</p>
  <ul>
    <li>Los puertos, junto con la topolog√≠a de red: El malware suele utilizar protocolos comunes para comunicarse y es esencial comprender la pila de red y los protocolos comunes.</li>
    <li>Todos los dispositivos en la red deben ser analizados, ya que los atacantes suelen moverse lateralmente.</li>
    <li>Un diagrama completo de la red.</li>
  </ul>

  <h4>Anomal√≠as del DNS</h4>
  <p>Las solicitudes DNS a dominios inusuales o sospechosos pueden ser generadas por malware que establece canales de control y comando. El monitoreo y la inclusi√≥n en listas negras de:</p>
  <ul>
    <li>Volumen anormal: Un volumen inusual de solicitudes DNS desde una determinada computadora o para un dominio determinado puede indicar un ataque.</li>
    <li>Hits en listas negras: Las solicitudes a dominios maliciosos conocidos indican que un sistema ha sido infectado con malware.</li>
    <li>Detectar tr√°fico DNS sospechoso:</li>
    <ul>
      <li>Recopilar paquetes de tr√°fico DNS</li>
      <li>Identificar y eliminar el tr√°fico conocido como bueno</li>
      <li>Analizar lo que queda.</li>
    </ul>
    <li>Conexiones DNS din√°micas: Las conexiones a dominios alojados en proveedores de DNS din√°micos pueden indicar comunicaci√≥n C2.</li>
    <li>Tr√°fico denegado de salida: El malware dentro de una red puede necesitar comunicarse con un servidor C2. Este tr√°fico puede ser bloqueado por firewalls u otros dispositivos de seguridad de red.</li>
    <li>Anomal√≠as en solicitudes y respuestas HTTP:</li>
    <ul>
      <li>Request: Grandes n√∫meros de solicitudes repetidas para los mismos recursos pueden indicar.</li>
      <li>Response: Las respuestas inusualmente grandes pueden indicar una inyecci√≥n SQL exitosa.</li>
    </ul>
    <li>Anomal√≠as geogr√°ficas: Intentos de autenticaci√≥n desde ubicaciones inusuales.</li>
  </ul>
</details>

<details>
  <summary><strong>Day 14: Threats in Networks</strong></summary>
  
  <p>El d√≠a de hoy he estado examinando diversas amenazas que pueden afectar nuestro entorno de red. Entre ellas, la detecci√≥n de ataques DDoS y la identificaci√≥n de dominios sospechosos.</p>

  <h4>Ataques de Denegaci√≥n de Servicio Distribuido (DDoS)</h4>
  <p>Un ataque DDoS ocurre cuando m√∫ltiples m√°quinas atacantes intentan sobrecargar a las m√°quinas v√≠ctimas.</p>
  <p>Algunos indicios de un ataque DDoS:</p>
  <ul>
    <li>Indisponibilidad de sitios web.</li>
    <li>Rendimiento lento de la red.</li>
    <li>Sistemas internos operando al m√°ximo de su capacidad.</li>
    <li>Sobrecarga de sistemas de seguridad de red (SIEM, IPS-IDS).</li>
    <li>Disponibilidad inesperada del servidor.</li>
  </ul>
  <p>Direcciones IP conectadas a muchos puertos diferentes pueden indicar un ataque de DoS.</p>

  <h4>Threat Hunting de Dominios Sospechosos</h4>
  <p>Motivos por los cuales un dominio puede ser sospechoso:</p>
  <ul>
    <li>Dominios aleatorios generados por un DGA.</li>
    <li>Direcciones IP ocultas.</li>
    <li>Extensiones de dominio inusuales.</li>
    <li>Dominios inexistentes.</li>
    <li>Dominios conocidos como maliciosos.</li>
  </ul>
  <p>La informaci√≥n de un dominio se puede encontrar en registros DNS, correos electr√≥nicos y registros web. Es importante para detectar riesgos y protegerse contra actividades maliciosas.</p>

  <h4>URLs</h4>
  <p>Las URL son indicadores comunes de compromiso y se utilizan en ataques de phishing, spam y malware.</p>
  <p>Ataques basados en URL:</p>
  <ul>
    <li>Redirecci√≥n.</li>
    <li>Typosquatting.</li>
    <li>Codificaci√≥n de escape.</li>
  </ul>

  <h4>Respuestas HTML Sospechosas</h4>
  <p>El tama√±o de la respuesta HTML es clave. En los ataques de inyecci√≥n SQL, las respuestas suelen ser grandes debido a datos exfiltrados.</p>
  <p>Los registros de servidores web son √∫tiles para identificar ataques:</p>
  <ul>
    <li>Respuestas HTML grandes pueden indicar intentos de inyecci√≥n SQL y exfiltraci√≥n de datos.</li>
    <li>Errores 500 Internal Server y errores 501 Header Value pueden indicar escaneos en busca de vulnerabilidades.</li>
  </ul>
  <p>Es crucial estar atento a actividades inusuales que puedan indicar una brecha de seguridad.</p>
</details>

<details>
  <summary><strong>Day 15: Threats in Network</strong></summary>
  
  <p>Hoy he estado investigando sobre la caza de tr√°fico irregular, mirando ejemplos de detecci√≥n de web shells y la exfiltraci√≥n de datos. Adem√°s, he estado configurando un entorno de laboratorio con ELK stack para poner en pr√°ctica el hunting en la red con ejemplos.</p>

  <h4>Hunting de tr√°fico irregular</h4>
  <p>Las irregularidades en el tr√°fico de red son indicadores √∫tiles para los cazadores de amenazas. Los autores de malware utilizan diversas t√©cnicas para ocultar ataques de comando y control, como protocolos mal utilizados y desajustes entre puertos y aplicaciones.</p>
  <p>El intento de ejecuci√≥n de web shells es un vector de ataque inicial com√∫n. Es crucial detectarlos tempranamente.</p>
  <p>Algunas detecciones clave incluyen:</p>
  <ul>
    <li>Protocolos mal utilizados: Se emplean protocolos inusuales en un puerto concreto.</li>
    <li>Desajustes entre puertos y aplicaciones: Los autores de malware pueden utilizar puertos comunes o personalizados para hacer que el tr√°fico malicioso parezca leg√≠timo. Observar registro de datos para encontrar anomal√≠as y patrones sospechosos es crucial.</li>
    <li>Web Shells: Son una forma il√≠cita de obtener acceso a una terminal de una computadora a trav√©s de una p√°gina web din√°mica en el lado del servidor.</li>
  </ul>
  <p>Herramientas de detecci√≥n: Parte de suites de caza de amenazas o herramientas independientes como Webshell Scan, Scalp y Neopi.</p>

  <h4>Exfiltraci√≥n de datos</h4>
  <p>Detectarla es complejo, especialmente sin una buena l√≠nea base del tr√°fico saliente normal.</p>
  <p>Las soluciones de Protecci√≥n de P√©rdida de Datos (DLP) pueden pasar por alto eventos de exfiltraci√≥n debido a diversas razones:</p>
  <ul>
    <li>Los exploits de exfiltraci√≥n suelen ser pasos intermedios en un ataque y no siempre afectan a los datos protegidos por DLP.</li>
    <li>Las redes de explotaci√≥n distribuida son dif√≠ciles de detectar para las soluciones de DLP.</li>
  </ul>
  <p>Para detectar la exfiltraci√≥n de datos, es crucial monitorear patrones de tr√°fico y usar t√©cnicas de an√°lisis avanzadas.</p>
</details>

<details>
  <summary><strong>Day 16: Practice examples of Network Hunting</strong></summary>
  
  <p>El d√≠a de hoy he terminado de a√±adir la informaci√≥n recopilada sobre el hunting en redes. Pod√©is echarle un ojo en mi <a href="https://nottaroff.github.io/workspace/docs/100%20days/4.%20Hunting%20en%20entornos%20de%20red/">blog</a>.</p>

  <p>Como parte pr√°ctica, he realizado un ejercicio de detecci√≥n de un ataque C2 (command and control) al DNS. He utilizado el entorno de Elastic online, cargando los datos. Pod√©is ver los detalles en este <a href="https://nottaroff.github.io/workspace/docs/100%20days/Ejemplos%20pr√°cticos%20Hunting%20en%20Red/">post</a>.</p>

  <p>Estos d√≠as seguir√© realizando varios ejercicios pr√°cticos de detecci√≥n de ataques en la red y modificando el blog.</p>
</details>

<details>
  <summary><strong>‚Å†‚Å†‚Å†Day 17: Practice examples of Network Hunting II</strong></summary>
  <p>El d√≠a de hoy he realizado otros dos ejemplos de hunting en entornos de red. Concretamente en detectar posibles ataques a una aplicaci√≥n web mediante la ejecuci√≥n remota de c√≥digo y otra pr√°ctica sobre actividades de phishing detectando enlaces maliciosos y archivos adjuntos abiertos o descargados desde diferentes estaciones de trabajo.</p>
  
  <p>Pod√©is echarle un ojo al reporte aqu√≠:</p>
  
  <p>Ejecuci√≥n remota de c√≥digo en Web: <a href="https://nottaroff.github.io/workspace/docs/100%20days/Ejemplos%20pr√°cticos%20Hunting%20en%20Red/#ejecuci√≥n-remota-de-c√≥digo-en-web-%EF%B8%8F">Informe</a></p>
  
  <p>Enlaces y Archivos de Phishing: <a href="https://nottaroff.github.io/workspace/docs/100%20days/Ejemplos%20pr√°cticos%20Hunting%20en%20Red/#enlaces-y-archivos-de-phishing-">Informe</a></p>
</details>

<details>
  <summary><strong>‚Å†Day 18: Malware Hiding Techniques</strong></summary>
  <p>El d√≠a de hoy he estado investigando sobre las t√©cnicas de evasi√≥n que utiliza el malware para pasar desapercibido en los sistemas de detecci√≥n, concretamente los que dependen de firmas o patrones predefinidos.</p>
  
  <p><strong>Extracto:</strong></p>
  <ul>
    <li><strong>Malware Polim√≥rfico:</strong> Es un tipo de software malicioso que cambia su c√≥digo o apariencia con cada infecci√≥n, dificultando su detecci√≥n y bloqueo por parte de los antivirus tradicionales basados en firmas.</li>
    <li><strong>Malware Metam√≥rfico:</strong> Modifica tanto su c√≥digo, estructura y comportamiento en cada infecci√≥n.</li>
    <li><strong>Cifrado de archivos:</strong> Consiste en codificar el c√≥digo malicioso o componentes para ocultar su verdadero prop√≥sito y evitar ser detectado por el software de seguridad.</li>
    <li><strong>Empaquetadores:</strong> Comprimen y cifran el c√≥digo del malware, creando un nuevo ejecutable que requiere una rutina de desempaquetado espec√≠fica para ser ejecutada.</li>
    <li><strong>Cifradores:</strong> Se centran en cifrar el c√≥digo del malware y generar una rutina de descifrado que puede reconstituir la carga √∫til maliciosa original en tiempo de ejecuci√≥n.</li>
    <li><strong>Ofuscaci√≥n de C√≥digo:</strong> Manipulaci√≥n intencional de la estructura, l√≥gica y presentaci√≥n del c√≥digo para hacerlo m√°s complejo y ocultar los patrones reconocibles del malware.</li>
  </ul>
  
  <p><strong>REFERENCIAS:</strong></p>
  <ul>
    <li><a href="https://blog.barracuda.com/2023/11/09/malware-101-signature-evasion-techniques">Malware 101: Signature Evasion Techniques</a></li>
    <li><a href="https://www.cyfirma.com/research/malware-detection-evasion-techniques/">Malware Detection Evasion Techniques</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 19: Behaviour-based Evasion Techniques</strong></summary>
  <p>El d√≠a de hoy he visto las diferentes t√©cnicas de evasi√≥n basadas en el comportamiento del sistema que utiliza el malware para alterar sus acciones y caracter√≠sticas y evadir su detecci√≥n, con algunos ejemplos reales.</p>
  
  <p><strong>Extracto:</strong></p>
  <ul>
    <li><strong>Detecci√≥n de sandbox:</strong> El malware puede detectar ciertos comportamientos asociados con entornos de an√°lisis y alterar su comportamiento para evadir el an√°lisis.</li>
    <li><strong>Trickbot:</strong> Troyano bancario que se propaga principalmente a trav√©s de correos electr√≥nicos de phishing y es utilizado para robar informaci√≥n financiera y credenciales de inicio de sesi√≥n. <a href="https://attack.mitre.org/software/S0266/">Referencia</a></li>
    <li><strong>Comprobaci√≥n del entorno:</strong> Se eval√∫a el contexto en el que se est√° ejecutando el malware y puede alterar su comportamiento para evadir la detecci√≥n.</li>
    <li><strong>Emotet:</strong> Emplea t√©cnicas de comprobaci√≥n del entorno para detectar an√°lisis de seguridad y puede cambiar su comportamiento en consecuencia. <a href="https://attack.mitre.org/software/S0367/">Referencia</a></li>
    <li><strong>Vaciamiento de Procesos:</strong> El malware emplaza su propio c√≥digo malicioso dentro de procesos leg√≠timos del sistema para ejecutar acciones maliciosas en segundo plano.</li>
    <li><strong>Poweliks:</strong> Este malware busca un proceso leg√≠timo en el sistema y luego inyecta su c√≥digo dentro del proceso, reemplazando su funcionalidad leg√≠tima con la suya propia. <a href="https://attack.mitre.org/techniques/T1218/011/">Referencia</a></li>
  </ul>
</details>

<details>
  <summary><strong>Day 20: Inyecci√≥n de malware en procesos y Malware sin archivos</strong></summary>
  <p>El d√≠a de hoy he visto las estrategias que utiliza el malware para insertar su c√≥digo malicioso en procesos leg√≠timos, as√≠ como tambi√©n el malware que no es un archivo en s√≠ mismo, sino c√≥digo malicioso que opera completamente dentro de la memoria de una computadora, sin dejar rastro en el sistema de archivos.</p>
  
  <p><strong>T√©cnicas de Inyecci√≥n de Procesos:</strong></p>
  <ul>
    <li><strong>Inyecci√≥n de DLL:</strong> Inyecci√≥n de procesos en la que un c√≥digo malicioso inserta su propia Biblioteca de Enlaces Din√°micos (DLL) en un proceso leg√≠timo que se est√° ejecutando en memoria.</li>
    <li><strong>Inyecci√≥n de C√≥digo:</strong> Se inserta c√≥digo malicioso en el espacio de memoria de un proceso leg√≠timo, alterando su comportamiento para llevar a cabo acciones maliciosas.</li>
    <li><strong>Inyecci√≥n de Hilos:</strong> El c√≥digo malicioso crea un nuevo hilo dentro de un proceso leg√≠timo e inyecta su carga √∫til en el flujo de ejecuci√≥n de ese hilo.</li>
    <li><strong>T√©cnicas de Asignaci√≥n/Escritura de Memoria:</strong> El malware se asigna din√°micamente memoria dentro del espacio de direcciones del proceso objetivo y luego escribe su carga √∫til en esa memoria asignada.</li>
  </ul>
  
  <p><strong>T√©cnicas de Malware Sin Archivos:</strong></p>
  <ul>
    <li><strong>Ejecuci√≥n Basada en Memoria:</strong> El c√≥digo malicioso se carga y ejecuta directamente en la memoria del sistema.</li>
    <li><strong>T√©cnicas de "Living-off-the-land" (LOLbins):</strong> Utilizan herramientas y procesos del sistema preexistentes y confiables para ejecutar actividades maliciosas, a menudo sin necesidad de crear nuevos archivos.</li>
    <li><strong>Ataques Basados en el Registro:</strong> Implican explotar el Registro de Windows con fines maliciosos.</li>
    <li><strong>Macros de Documentos:</strong> Se usan scripts integrados dentro de archivos de documentos para realizar acciones maliciosas al abrir el documento.</li>
  </ul>
  
  <p>Puedes encontrar m√°s informaci√≥n y ejemplos detallados en los siguientes enlaces de referencia:</p>
  <ul>
    <li><a href="https://attack.mitre.org/software/S0154/">Ejemplo de Cobalt Strike utilizado en ataques de red dirigidos</a></li>
    <li><a href="https://attack.mitre.org/software/S0446/">Ejemplo de t√©cnicas LOLbins utilizadas por Ryuk en ataques de ransomware</a></li>
    <li><a href="https://attack.mitre.org/software/S0384/">Ejemplo de ataques basados en el Registro utilizados por Dridex</a></li>
    <li><a href="https://attack.mitre.org/software/S0386/">Ejemplo de macros de documentos utilizados por Ursnif</a></li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†Day 21: Detecci√≥n de procesos irregulares</strong></summary>
  <p>El d√≠a de hoy, he visto que uno de los modos m√°s comunes en que el malware intenta evitar la detecci√≥n es haci√©ndose pasar por un proceso leg√≠timo dentro de un sistema, as√≠ que he estado investigando c√≥mo lo hace y c√≥mo podemos detectarlo.</p>
  
  <p><strong>Extracto de t√©cnicas que usa el malware para pasar desapercibido:</strong></p>
  <ul>
    <li><strong>Suplantaci√≥n de procesos cr√≠ticos:</strong> El malware puede hacerse pasar por procesos leg√≠timos ejecut√°ndose bajo un nombre similar. Una forma de detectar este malware es usar algoritmos de similitud de cadenas para buscar cadenas que no sean iguales pero tampoco muy diferentes.</li>
    <li><strong>Ubicaciones ejecutables inusuales:</strong> El malware puede ejecutarse desde ubicaciones inusuales para dificultar su detecci√≥n. Tambi√©n podemos ver c√≥mo algunos aprovechan ubicaciones espec√≠ficas como parte de sus t√°cticas de evasi√≥n y secuestro.</li>
    <li><strong>Jerarqu√≠a de procesos:</strong> La jerarqu√≠a de procesos es una caracter√≠stica fundamental tanto en sistemas Windows como en Unix. Al buscar irregularidades en esta jerarqu√≠a podemos identificar posibles suplantadores o procesos maliciosos.</li>
    <li><strong>Secuestro de procesos:</strong> Algunos tipos de malware pueden tomar el control de un proceso existente y ejecutar con su espacio de memoria y permisos. Esto puede lograrse mediante ganchos de funci√≥n, modificaciones/patching en l√≠nea o inyecci√≥n de DLL (Dynamic Link Library).</li>
  </ul>
</details>

<details>
  <summary><strong>Day 22: Detecci√≥n de Movimiento Lateral</strong></summary>
  <p>El d√≠a de hoy he visto los puntos estrat√©gicos cruciales en la detecci√≥n de movimiento lateral en endpoints durante el threat hunting.</p>
  
  <p><strong>Extracto:</strong></p>
  <ul>
    <li><strong>Movimientos laterales y reconocimiento:</strong> Los atacantes avanzan lateralmente dentro de una red una vez que comprometen un punto de entrada inicial, recopilando informaci√≥n sobre usuarios, privilegios y sistemas accesibles para planificar sus siguientes movimientos.</li>
    <li><strong>Uso expl√≠cito de credenciales:</strong> La autenticaci√≥n mediante credenciales expl√≠citas es com√∫n en entornos Windows, pero representa una vulnerabilidad potencial que los atacantes pueden aprovechar. Es esencial implementar un monitoreo proactivo de las credenciales expl√≠citas y establecer listas blancas para usuarios y aplicaciones autorizadas.</li>
    <li><strong>Monitoreo del registro y archivos del sistema:</strong> Tanto el registro como los archivos del sistema son objetivos principales para el malware en busca de persistencia y control. La auditor√≠a del registro y el monitoreo de las marcas de tiempo de los archivos son pr√°cticas esenciales para identificar cambios inusuales que podr√≠an indicar actividad maliciosa.</li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†Day 23: Detecci√≥n de malware en archivos del sistema</strong></summary>
  <p>En el threat hunting enfocado a los endpoint, es importante tener constancia de los archivos presentes en el sistema y las actividades an√≥malas. Hoy he estado investigando qu√© tener en cuenta al buscar amenazas a la hora de analizar los archivos y algunos ejemplos.</p>
  
  <p><strong>Extracto de los temas investigados:</strong></p>
  <ul>
    <li><strong>Nombres de archivo maliciosos conocidos:</strong> Ciertas familias de malware usan nombres predecibles en sus t√°cticas de infecci√≥n y persistencia en sistemas comprometidos. Identificar estos nombres es una estrategia efectiva para un cazador de amenazas.</li>
    <li><strong>Extensiones de archivo:</strong> Los autores de malware utilizan diversas extensiones para sus ejecutables, como .exe, .bat, .cmd, .com, .lnk, .pif, .vbs, .scr y .wsh. Tambi√©n es importante considerar que otras extensiones pueden representar una amenaza potencial.</li>
    <li><strong>Anulaci√≥n de izquierda a derecha:</strong> Es una t√©cnica usada por atacantes para ocultar informaci√≥n maliciosa en nombres de archivos y textos, dificultando la detecci√≥n de nombres de archivo maliciosos.</li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†‚Å†Day 24: Data source de equipos para el Threat Hunting</strong></summary>
  <p>Los datos que podemos visualizar en los endpoints no ofrecen una visi√≥n detallada de la actividad en cada dispositivo. Esto es importante para poder detectar indicadores de compromiso y comportamientos an√≥malos. Hoy he estado repasando los diferentes puntos de recopilaci√≥n de informaci√≥n que se pueden obtener de equipos con Windows/Linux.</p>
  
  <p><strong>Extracto sobre puntos importantes:</strong></p>
  <ul>
    <li><strong>AV Basado en el Host:</strong> Permite la detecci√≥n de antivirus en m√°quinas individuales, con reglas personalizadas que pueden adaptarse a las necesidades de seguridad espec√≠ficas de cada dispositivo.</li>
    <li><strong>Sistemas de Detecci√≥n/Prevenci√≥n de Intrusiones Basados en el Host:</strong>
      <ul>
        <li><strong>HIDS (Sistema de Detecci√≥n de Intrusiones Basado en el Host):</strong> Detecta posibles amenazas y ataques en un sistema de host mediante la monitorizaci√≥n de la actividad del sistema en busca de cambios sospechosos y actividad de malware.</li>
        <li><strong>HIPS (Sistema de Prevenci√≥n de Intrusiones Basado en el Host):</strong> Previene la actividad maliciosa en un sistema de host mediante el uso de an√°lisis de comportamiento, control de aplicaciones y prevenci√≥n de intrusos en la red.</li>
      </ul>
    </li>
    <li><strong>Registros de Antivirus:</strong> Estos registros pueden incluir eventos de detecci√≥n de amenazas, actualizaciones de firmas, an√°lisis programados y acciones tomadas por el software antivirus para mitigar las amenazas detectadas.</li>
    <li><strong>Firewalls Basados en el Host:</strong> Proporcionan visibilidad y control granulares sobre el tr√°fico de red en sistemas individuales. Los registros del firewall pueden analizarse para identificar patrones de tr√°fico sospechoso y actividades maliciosas.</li>
    <li><strong>Registros de Eventos de Windows:</strong> Estos registros proporcionan informaci√≥n detallada sobre los eventos del sistema, como intentos de inicio de sesi√≥n, instalaciones de software y errores del sistema. La revisi√≥n de estos registros puede ayudar a identificar actividades maliciosas y posibles puntos de compromiso en los sistemas Windows.</li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†Day 25: Calidad de Datos y Metodolog√≠as</strong></summary>
  <p>Despu√©s de explorar las diferentes fuentes de datos, he investigado la importancia de la calidad de los datos en la caza de amenazas:</p>
  
  <p><strong>Calidad de Datos en la Caza:</strong></p>
  <ul>
    <li><strong>Objetivos de Calidad de Datos:</strong>
      <ul>
        <li>Mejora de la Productividad: Reducir el tiempo dedicado a corregir problemas de datos.</li>
        <li>Consistencia y Complejidad: La consistencia entre fuentes de datos facilita an√°lisis complejos.</li>
        <li>Automatizaci√≥n Eficiente: Mejorar la calidad de datos optimiza los procesos de automatizaci√≥n.</li>
      </ul>
    </li>
    <li><strong>Importancia de la Calidad de Datos:</strong> Problemas comunes, como discrepancias en los campos de datos, impactan en la capacidad de detectar y responder a amenazas.</li>
    <li><strong>Metodolog√≠a B√°sica:</strong>
      <ol>
        <li>Identificaci√≥n de Fuentes de Datos</li>
        <li>Determinaci√≥n de Fuentes Necesarias</li>
        <li>Mapeo de Fuentes de Datos</li>
        <li>Definici√≥n de Dimensiones de Calidad</li>
        <li>Desarrollo de Sistema de Puntuaci√≥n</li>
        <li>Evaluaci√≥n de la Calidad</li>
      </ol>
    </li>
    <li><strong>Puntuaci√≥n General:</strong> Integrar puntuaciones de calidad de datos con evaluaciones de talento y tecnolog√≠a nos proporciona una m√©trica completa para medir la efectividad en los compromisos de caza de amenazas.</li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†Day 25: Calidad de Datos y Metodolog√≠as</strong></summary>
  <p>Despu√©s de explorar las diferentes fuentes de datos, he investigado la importancia de la calidad de los datos en la caza de amenazas:</p>
  
  <p><strong>Calidad de Datos en la Caza:</strong></p>
  <ul>
    <li><strong>Objetivos de Calidad de Datos:</strong>
      <ul>
        <li>Mejora de la Productividad: Reducir el tiempo dedicado a corregir problemas de datos.</li>
        <li>Consistencia y Complejidad: La consistencia entre fuentes de datos facilita an√°lisis complejos.</li>
        <li>Automatizaci√≥n Eficiente: Mejorar la calidad de datos optimiza los procesos de automatizaci√≥n.</li>
      </ul>
    </li>
    <li><strong>Importancia de la Calidad de Datos:</strong> Problemas comunes, como discrepancias en los campos de datos, impactan en la capacidad de detectar y responder a amenazas.</li>
    <li><strong>Metodolog√≠a B√°sica:</strong>
      <ol>
        <li>Identificaci√≥n de Fuentes de Datos</li>
        <li>Determinaci√≥n de Fuentes Necesarias</li>
        <li>Mapeo de Fuentes de Datos</li>
        <li>Definici√≥n de Dimensiones de Calidad</li>
        <li>Desarrollo de Sistema de Puntuaci√≥n</li>
        <li>Evaluaci√≥n de la Calidad</li>
      </ol>
    </li>
    <li><strong>Puntuaci√≥n General:</strong> Integrar puntuaciones de calidad de datos con evaluaciones de talento y tecnolog√≠a nos proporciona una m√©trica completa para medir la efectividad en los compromisos de caza de amenazas.</li>
  </ul>
</details>

<details>
  <summary><strong>Day 26: Ejemplos de b√∫squeda de threats</strong></summary>
  <p>El otro d√≠a consult√© d√≥nde buscar las principales fuentes de datos de las que disponemos a la hora de buscar amenazas. Hoy he visto, en algunos casos pr√°cticos m√°s en detalle, qu√© tipo de amenazas podemos detectar en diferentes fuentes.</p>
  
  <p><strong>Registros de Proxy:</strong></p>
  <ul>
    <li><strong>Tr√°fico no autorizado:</strong> Identificar cualquier tr√°fico que se env√≠e a trav√©s de puertos no autorizados, como el puerto 22, que podr√≠a indicar intentos de exfiltraci√≥n de datos.</li>
    <li><strong>Patrones de conexi√≥n:</strong> Buscar conexiones que exhiban patrones consistentes de bytes de entrada y salida, lo que podr√≠a ser una se√±al de que se est√° utilizando una t√©cnica de balizamiento para comunicarse con un servidor de comando y control.</li>
  </ul>
  
  <p><strong>Registros de Windows:</strong></p>
  <ul>
    <li><strong>Inicio de sesi√≥n con credenciales expl√≠citas:</strong> Filtrar eventos de inicio de sesi√≥n que utilicen credenciales expl√≠citas, ya que esto podr√≠a indicar intentos de movimiento lateral por parte de un atacante.</li>
    <li><strong>Cambios en grupos privilegiados:</strong> Monitorear los cambios en los grupos privilegiados, ya que esto podr√≠a indicar intentos de escalada de privilegios por parte de un intruso.</li>
    <li><strong>Intentos de inicio de sesi√≥n fallidos:</strong> Buscar patrones de intentos de inicio de sesi√≥n fallidos, especialmente aquellos que provienen de m√∫ltiples cuentas, lo que podr√≠a indicar un intento de ataque de fuerza bruta.</li>
  </ul>
  
  <p><strong>Registros de Antivirus:</strong></p>
  <ul>
    <li><strong>Detecci√≥n de programas de volcado de contrase√±as:</strong> Identificar cualquier detecci√≥n de programas conocidos de volcado de contrase√±as, como pwdump o mimikatz, ya que esto podr√≠a indicar intentos de robo de credenciales.</li>
    <li><strong>Ejecuciones de programas desconocidos:</strong> Buscar ejecuciones de programas desconocidos que podr√≠an ser herramientas maliciosas utilizadas por un atacante para comprometer el sistema.</li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†‚Å†Day 27: Hunting en entornos de endpoints</strong></summary>
  <p>El d√≠a de hoy he actualizado toda la informaci√≥n recopilada durante estos d√≠as referente al Threat Hunting en Endpoints.</p>
  
  <p>Los puntos detallados son:</p>
  <ol>
    <li><a href="https://nottaroff.github.io/workspace/docs/100%20days/5.%20Hunting%20en%20entornos%20de%20endpoint/#51-t√©cnicas-de-ocultaci√≥n-de-malware-" target="_blank">5.1 T√©cnicas de Ocultaci√≥n de Malware</a></li>
    <li><a href="https://nottaroff.github.io/workspace/docs/100%20days/5.%20Hunting%20en%20entornos%20de%20endpoint/#52-descubriendo-procesos-irregulares" target="_blank">5.2 Descubriendo procesos irregulares</a></li>
    <li><a href="https://nottaroff.github.io/workspace/docs/100%20days/5.%20Hunting%20en%20entornos%20de%20endpoint/#54-t√©cnicas-de-adquisici√≥n-de-datos-en-threat-hunting" target="_blank">5.3 Detecci√≥n de movimiento Lateral</a></li>
    <li><a href="https://nottaroff.github.io/workspace/docs/100%20days/5.%20Hunting%20en%20entornos%20de%20endpoint/#54-t√©cnicas-de-adquisici√≥n-de-datos-en-threat-hunting" target="_blank">5.4 T√©cnicas de Adquisici√≥n de Datos en Threat Hunting</a></li>
  </ol>
</details>

<details>
  <summary><strong>Day 28: Detecci√≥n de conexiones de larga duraci√≥n</strong></summary>
  <p>El d√≠a de hoy he creado un peque√±o laboratorio con una VM Ubuntu. Utilizando Wireshark, Zeek y Rita con el objetivo de identificar conexiones de red de larga duraci√≥n.</p>
  <p>Puedes acceder al laboratorio en el siguiente enlace: <a href="https://activecm.github.io/threat-hunting-labs/long_connections/" target="_blank">Laboratorio de conexiones de larga duraci√≥n</a></p>
  <p>Wireshark permite visualizar y analizar paquetes de red, mientras que Zeek genera registros detallados de la actividad de la red. Ambas herramientas son fundamentales para identificar conexiones TCP y UDP de larga duraci√≥n, lo que se logra ordenando las conexiones por duraci√≥n. Es importante tener en cuenta que las diferencias en el manejo de conexiones UDP entre Wireshark y Zeek pueden influir en los resultados del an√°lisis.</p>
  <p>Adem√°s, es crucial considerar el comportamiento del malware, que puede generar conexiones intermedias de duraci√≥n media para evitar la detecci√≥n de conexiones de larga duraci√≥n. Por lo tanto, es necesario evaluar no solo la duraci√≥n de las conexiones, sino tambi√©n su naturaleza y posibles implicaciones de seguridad.</p>
</details>

<details>
  <summary><strong>‚Å†‚Å†Day 29: Sentinel Threat Hunting Course</strong></summary>
  <p>El d√≠a de hoy he empezado un curso de Threat Hunting en los recursos de SentinelOne. El curso es realizar hunting con el entorno de Sentinel, pero tambi√©n tiene teor√≠a introductoria y ejemplos de uso.</p>
  <p>Uno de los hallazgos que identifiqu√© durante el ejemplo pr√°ctico fue la detecci√≥n de una conexi√≥n entrante a un punto final a trav√©s del protocolo RDP desde una direcci√≥n IP externa. Adem√°s, se observaron conexiones entrantes en puertos espec√≠ficos, lo que podr√≠a indicar un posible abuso de herramientas como PSExec.</p>
  <p>Tambi√©n detect√© la ejecuci√≥n de comandos de sistema (cmd.exe) y scripts de PowerShell (powershell.exe), utilizados para acciones como la creaci√≥n de archivos y conexiones salientes a recursos externos.</p>
  <h3>Consultas Utilizadas:</h3>
  <ul>
    <li>Filtrado de conexiones RDP entrantes desde direcciones IP externas:
      <pre>DstPort = "3389" AND SrcIP Not In ("10.0.1.1", "10.0.1.10")</pre>
    </li>
    <li>B√∫squeda de instancias de PSExec no asociadas al usuario "administrador":
      <pre>ProcessName contains "PSExec" AND User not Contains "administrador"</pre>
    </li>
    <li>Identificaci√≥n de actividades de PowerShell conect√°ndose a trav√©s del puerto 21:
      <pre>Process contains "Powershell" AND DstPort = "21" AND ProcessCMD contains "iex"</pre>
    </li>
    <li>Detecci√≥n de comandos de PowerShell involucrando FTP y ejecuci√≥n de comandos:
      <pre>ProcessName contains "Powershell" AND ProcessCmd contains "ftp" AND ProcessCMD contains "iex"</pre>
    </li>
  </ul>
</details>

<details>
  <summary><strong>‚Å†‚Å†Day 30: Sentinel Threat Hunting Course II</strong></summary>
  <p>El d√≠a de hoy he seguido con el curso de Sentinel University sobre lo que tenemos que tener en cuenta a la hora de usar la opci√≥n de Visibility - Hunting.</p>
  <p>SentinelOne es un XDP que identifica y neutraliza posibles riesgos de seguridad en los sistemas. Al utilizar la funcionalidad de Deep Visibility, podemos examinar exhaustivamente eventos, artefactos y datos de objetos para detectar cualquier actividad sospechosa o maliciosa que pueda pasar desapercibida para los sistemas de detecci√≥n tradicionales.</p>
  <p>Cuando realizamos threat hunting en Sentinel, es importante tener en cuenta que buscamos nuevas variantes de malware que a√∫n no han sido detectadas por el sistema. Estas amenazas pueden ser √∫nicas y escapar de la detecci√≥n de inteligencia artificial. Por lo tanto, es crucial marcar toda la l√≠nea de tiempo como sospechosa o maliciosa y examinar cada evento en su totalidad para encontrar cualquier indicio de actividad no autorizada.</p>
  <p>Una vez identificada la actividad sospechosa, podemos utilizar la informaci√≥n detallada proporcionada por los objetos de visibilidad profunda para investigar la causa ra√≠z de la amenaza. Esto implica encontrar todos los artefactos relacionados con el incidente y determinar hasta qu√© punto el malware ha infiltrado nuestros sistemas.</p>
  <p>Adem√°s de responder a las amenazas detectadas, la informaci√≥n recopilada durante la caza de amenazas nos permite establecer reglas y pol√≠ticas de seguridad m√°s efectivas para prevenir futuros ataques. Con una comprensi√≥n clara de c√≥mo opera el malware y qu√© indicadores de compromiso buscar, podemos fortalecer nuestra postura de seguridad y proteger mejor nuestros sistemas.</p>
</details>

<details>
  <summary><strong>Day 31: Sentinel Threat Hunting Course Deep Visibility</strong></summary>
  <p>Siguiendo el curso de Threat Hunting con SentinelOne, el d√≠a de hoy he visto el uso de la funcionalidad de Deep Visibility. Este proceso se divide en varias etapas que abarcan desde la preparaci√≥n hasta la identificaci√≥n de actividades maliciosas, la obtenci√≥n de inteligencia y la ejecuci√≥n de consultas para descubrir posibles amenazas.</p>
  <p>En la fase de preparaci√≥n, destaca la importancia de identificar cualquier acci√≥n que otorgue a nuestro equipo una ventaja sobre los atacantes. La funcionalidad de Deep Visibility recopila una gran cantidad de informaci√≥n, podremos modificar el tipo de registro que realizar√° Sentinel al configurar la privacidad de Deep Visibility en las pol√≠ticas de Sentinel One.</p>
  <p>La fase de identificaci√≥n se centra en reconocer una serie de eventos como maliciosos y obtener inteligencia sobre las amenazas o vulnerabilidades que se van a investigar. Destacando la importancia de buscar evidencia, formular artefactos buscables y encontrar eventos que puedan llamar la atenci√≥n del equipo de seguridad.</p>
  <p>Finalmente, se detalla la ejecuci√≥n de queries para analizar los datos recopilados. En Sentinel tenemos presente diferentes tipos de consultas disponibles, como las relacionadas con la fecha y hora, num√©ricas, de enumeraci√≥n, de cadenas de caracteres y booleanas. Se han detallado el uso de declaraciones AND para dividir consultas en partes m√°s peque√±as y el manejo de errores al utilizar expresiones regulares.</p>
</details>

<details>
  <summary><strong>‚Å†Day 32: SentinelOne Threat Hunting Course Hunter</strong></summary>
  <p>Hoy he visto otras herramientas de SentinelOne dise√±adas para el Threat Hunting. En particular, me he centrado en la utilidad de Hunter, una extensi√≥n del navegador que recopila datos de p√°ginas web y genera consultas en Deep Visibility. Estas consultas est√°n dise√±adas espec√≠ficamente para identificar indicadores que podr√≠an sugerir la presencia de malware.</p>
  <p>Una caracter√≠stica interesante de Hunter es su biblioteca de consultas, que automatiza la b√∫squeda de malware con actualizaciones m√°s frecuentes que las disponibles en la consola de gesti√≥n est√°ndar de SentinelOne. Esta capacidad de actualizaci√≥n constante proporciona una ventaja significativa en la detecci√≥n proactiva de amenazas.</p>
  <p>Adem√°s de explorar Hunter, he examinado varios enfoques para la b√∫squeda de malware dentro de la consola de gesti√≥n. Esto incluye la capacidad de modificar libremente los m√≥dulos dentro del registro, lo que permite una adaptaci√≥n m√°s precisa a las necesidades espec√≠ficas de la red y del entorno de amenazas.</p>
  <p>Por √∫ltimo, he utilizado la consulta EventType "File Creation" para identificar r√°pidamente archivos potencialmente maliciosos. Es importante tener en cuenta que los archivos del Explorador pueden representar una fuente de problemas en los endpoints, por lo que se recomienda una evaluaci√≥n cuidadosa de su inclusi√≥n en las investigaciones de amenazas.</p>
</details>

<details>
  <summary><strong>‚Å†‚Å†Day 33: Pr√°ctica Threat Hunting con SentinelOne</strong></summary>
  <p>El d√≠a de hoy he realizado el laboratorio de S1 University para el threat hunting con SentinelOne con el prop√≥sito de practicar la identificaci√≥n y mitigaci√≥n de amenazas, en este caso, un troyano de acceso remoto (RAT) en un entorno Linux mediante el uso de la Consola de Gesti√≥n de SentinelOne.</p>
  <p><strong>Pasos Realizados durante la pr√°ctica:</strong></p>
  <ul>
    <li>Preparaci√≥n para la Infecci√≥n:</li>
    <ul>
      <li><code>sudo nc -l -p 666</code>: Puerto de escucha con Netcat.</li>
      <li><code>sudo /home/forensics/Desktop/yoyobins.sh</code>: Ejecuci√≥n del malware.</li>
      <li><code>sudo netstat -peanut | grep 172.245.7.14:666</code>: Lista de conexiones de red activas al servidor C2.</li>
    </ul>
    <li>Investigaci√≥n en la Consola de SentinelOne:</li>
    <ul>
      <li>Uso de consultas de Deep Visibility para identificar la actividad maliciosa y asociar un Storyline Id con la cadena de infecci√≥n.</li>
      <li>Ejemplos de consultas utilizadas:</li>
      <ul>
        <li><code>NetConnOutCount > "5"</code></li>
        <li><code>DstIP RegExp "..."</code></li>
        <li><code>EndpointName ContainsCIS "" AND ChildProcCount > "50"</code></li>
        <li><code>DstIP RegExp "\\b(?!10\\.|192\\.168\\.|172\\.(?:1[6-9]|2[0-9]|3[01])\\.)(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]?[0-9])){3}\\b" AND SrcProcSignedStatus = "unsigned"</code></li>
      </ul>
      <li>Identificaci√≥n del Storyline Id del proceso malicioso y marcado como amenaza.</li>
    </ul>
    <li>An√°lisis Detallado:</li>
    <ul>
      <li>Inspecci√≥n del √°rbol de procesos para comprender el comportamiento del malware.</li>
    </ul>
    <li>Mitigaci√≥n de Amenazas:</li>
    <ul>
      <li>Ejecuci√≥n de acciones de mitigaci√≥n seleccionando "QUARANTINE" y marcando las amenazas como resueltas y verdaderas positivas.</li>
      <li>Verificaci√≥n de la cuarentena y mitigaci√≥n de los archivos maliciosos.</li>
    </ul>
  </ul>
</details>

<details>
  <summary><strong>Day 34: Hunting an APT with Splunk</strong></summary>
  <p>Hoy empiezo voy a empezar unos ejercicios de Hunting an APT.</p>
  <p>En el ejercicio de hoy:</p>
  <p>Se ha detectado una intrusi√≥n por parte del grupo APT Taedonggang. Se sospecha que los atacantes est√°n exfiltrando datos utilizando el protocolo FTP no cifrado, correspondiente a la t√©cnica T1048.003 seg√∫n el marco MITRE ATT&CK. <a href="https://attack.mitre.org/techniques/T1048/003/">https://attack.mitre.org/techniques/T1048/003/</a></p>
  <p><strong>Proceso de Detecci√≥n:</strong></p>
  <ul>
    <li>Fuentes de Datos Iniciales:</li>
    <ul>
      <li>Suricata: Detecci√≥n de intrusiones y an√°lisis de tr√°fico de red.</li>
      <li>Palo Alto Networks: Monitorizaci√≥n de amenazas.</li>
      <li>Sysmon (Microsoft): Registro de eventos operacionales detallados.</li>
    </ul>
    <li>Identificaci√≥n de Rutas de Comunicaci√≥n:</li>
    <ul>
      <li>Suricata: Eventos FTP.</li>
      <ul>
        <li><code>index=botsv2 ftp sourcetype="suricata" | stats count by src_ip dest_ip | sort - count</code></li>
        <li>Identificaci√≥n de hosts internos como estaciones de trabajo comprometidas.</li>
      </ul>
      <li>Palo Alto Networks: An√°lisis del tr√°fico de amenazas.</li>
      <ul>
        <li><code>index=botsv2 sourcetype=pan:threat | stats count by src_ip dest_ip | sort - count</code></li>
      </ul>
      <li>Sysmon: Identificaci√≥n de eventos de conexi√≥n de red.</li>
      <ul>
        <li><code>index=botsv2 ftp sourcetype="xmlwineventlog:microsoft-windows-sysmon/operational" | stats count by host | sort - count</code></li>
      </ul>
    </ul>
    <li>Comandos Ejecuci√≥n:</li>
    <ul>
      <li>Comandos relacionados con el uso del cliente FTP de Windows.</li>
      <ul>
        <li><code>"C:\Windows\system32\ftp.exe" open hildegardsfarm.com</code></li>
        <li>Indica una conexi√≥n FTP a un servidor externo para la transferencia de datos.</li>
      </ul>
    </ul>
    <li>An√°lisis Temporal de src/dest:</li>
    <ul>
      <li>An√°lisis de series temporales para detectar patrones de tr√°fico.</li>
      <ul>
        <li><code>index=botsv2 ftp sourcetype="pan:*" src=* dest=* | eval uniq=src." ".dest | timechart count by uniq</code></li>
        <li>Se detectaron picos de tr√°fico FTP el 23 y 25 de agosto.</li>
      </ul>
    </ul>
    <li>An√°lisis Detallado del Tr√°fico FTP:</li>
    <ul>
      <li>Se identificaron dos direcciones IP de origen relacionadas con eventos FTP.</li>
      <ul>
        <li><code>index=botsv2 ftp sourcetype="stream:ftp" src=* dest=160.153.91.7</code></li>
        <li>Transferencia de archivos desde estaciones de trabajo comprometidas a un servidor externo.</li>
      </ul>
    </ul>
  </ul>
</details>

<details>
  <summary><strong>Day 35: Hunting an APT with Splunk II</strong></summary>
  <p>El d√≠a de hoy termin√© la pr√°ctica de ayer.</p>
  <p><strong>El resumen de la caza de exfiltraci√≥n a trav√©s de FTP es:</strong></p>
  <ul>
    <li>Observamos que FTP se utiliz√≥ para la exfiltraci√≥n de datos.</li>
    <li>FTP fue utilizado principalmente y se observ√≥ en tres sistemas.</li>
  </ul>
  <p><strong>Acciones:</strong></p>
  <ul>
    <li>Basadas en el archivo winsys32.dll encontrado con el argumento -s en Sysmon.</li>
    <ul>
      <li>No fue completamente exitoso.</li>
      <li>Se observaron m√∫ltiples intentos, incluyendo un comando ftp open.</li>
    </ul>
  </ul>
  <ul>
    <li>Los dos equipos de trabajo, wrk-btun y wek-klagerf, se observaron comunic√°ndose con la IP externa 160[.]153[.]91[.]7 a trav√©s de m√∫ltiples fuentes.</li>
    <li>Los servidores mercury y venus solo se observaron en el tr√°fico de Palo Alto.</li>
    <li>El adversario est√° utilizando el comando ftp en los dos equipos de trabajo principalmente para intentar exfiltrar datos a esta direcci√≥n IP.</li>
    <li>Se utiliz√≥ un nombre de archivo con extensi√≥n dll para ocultar que se estaba llamando a un script.</li>
    <li>Los eventos de FTP proporcionan informaci√≥n sobre la actividad de carga y descarga.</li>
    <li>Los mismos siete archivos est√°n siendo descargados en ambos equipos de trabajo.</li>
    <li>Los archivos PDF de Froht.ly se est√°n cargando con √©xito varias veces, probablemente porque TopSecretYest.pdf parece no querer cargarse (PAN: Threat muestra bloqueado).</li>
    <li>El tr√°fico de exfiltraci√≥n est√° destinado a un dominio llamado hildegardsfarm.com.</li>
  </ul>
  <p>Puedes ver el reporte completo de la pr√°ctica aqu√≠: <a href="https://nottaroff.github.io/workspace/docs/Hunting%20an%20APT/1.%20Exfiltraci√≥n%20a%20trav√©s%20de%20FTP/">Reporte Completo</a></p>
</details>

<details>
  <summary><strong>D√≠a 36: Cazando un APT: Infraestructura del Adversario</strong></summary>
  <p>Continuando con la serie "Cazando un APT", hoy he llevado a cabo una pr√°ctica enfocada en la infraestructura de un grupo de ciberactores que ha estado perpetrando ataques en redes inform√°ticas de diversas organizaciones.</p>
  <p><strong>Los hallazgos clave son:</strong></p>
  <ul>
    <li>El grupo se centra en servidores web expuestos a Internet y utiliza certificados SSL autofirmados.</li>
    <li>Dependen de servidores VPS situados en pa√≠ses con pol√≠ticas de privacidad robustas, como Alemania.</li>
  </ul>
  <p><strong>Metodolog√≠a:</strong></p>
  <ul>
    <li>Centramos nuestra identificaci√≥n en la direcci√≥n IP **45[.]77[.]65[.]211** y analizamos el tr√°fico SSL en Splunk.</li>
    <li>Observamos varios hashes de certificados y los verificamos en OSINT para determinar su maliciosidad.</li>
    <li>Utilizamos herramientas de OSINT para geolocalizar la direcci√≥n IP, confirmando que los VPS est√°n desplegados en Alemania.</li>
  </ul>
  <p><strong>Conclusiones:</strong></p>
  <ul>
    <li>El adversario tiene al menos cuatro servidores adicionales desplegados, identificados mediante el hash de los certificados SSL.</li>
    <li>Buscar infraestructura del atacante sin pistas adicionales es desafiante y que los certificados SSL pueden proporcionar valiosa informaci√≥n sobre la misma.</li>
    <li>Los certificados SSL pueden proporcionar valiosa informaci√≥n sobre la infraestructura del adversario.</li>
  </ul>
  <p>Finalmente, sugerimos varios pasos a seguir, incluyendo la automatizaci√≥n de la recopilaci√≥n de OSINT, la corroboraci√≥n de fuentes y la vigilancia continua de los hashes de los certificados y las direcciones IP identificadas.</p>
  <p>Puedes ver m√°s en detalle en el siguiente enlace: Reporte Completo</p>
</details>

<details>
  <summary><strong>D√≠a 37: Cazando un APT - Cuenta Local</strong></summary>
  <p>En la continuaci√≥n de la serie "Cazando un APT", hoy me centr√© en la t√©cnica que utilizan los adversarios para mantener acceso persistente en equipos remotos, espec√≠ficamente en la creaci√≥n de cuentas locales sospechosas.</p>
  <p><strong>Identificaci√≥n de Eventos de Creaci√≥n de Cuentas:</strong></p>
  <ul>
    <li>Utilic√© el log de seguridad de Windows para buscar el ID de evento 4720, que indica la creaci√≥n de una cuenta.</li>
    <li>La consulta utilizada fue: <code>index=botsv2 sourcetype="wineventlog" EventCode=4720</code></li>
  </ul>
  <p><strong>An√°lisis de Eventos Encontrados:</strong></p>
  <ul>
    <li>Encontr√© 4 eventos de creaci√≥n de cuentas de usuario.</li>
    <li>Examin√© los nombres de cuenta clave, identificando las cuentas <code>svcnc</code>, <code>service3</code>, y <code>billy.tun</code> como sospechosas.</li>
  </ul>
  <p><strong>Verificaci√≥n de Sistemas Afectados:</strong></p>
  <ul>
    <li>Analic√© d√≥nde y cu√°ndo fueron creadas estas cuentas utilizando la consulta: <code>index=botsv2 sourcetype=wineventlog EventCode=4720 Account_Name=svcvnc | table _time host Account_Name SAM_Account_Name</code></li>
    <li>Observ√© que los registros de creaci√≥n de cuentas ocurrieron en dos estaciones de trabajo y dos servidores.</li>
    <li>Detect√© la creaci√≥n de la misma cuenta en cuatro sistemas diferentes en un corto per√≠odo de tiempo, lo cual es sospechoso.</li>
    <li>Utilic√© los comandos <code>table</code> y <code>transpose</code> en Splunk para comparar valores de atributos en los registros de eventos de Windows. Descubr√≠ que ciertos campos estaban consistentemente vac√≠os, lo cual es inusual.</li>
  </ul>
  <p>Para m√°s detalles, puedes consultar el an√°lisis completo en el siguiente enlace: An√°lisis Completo</p>
</details>


<details>
  <summary><strong>D√≠a 38: Cazando un APT - Cuenta Local</strong></summary>
  <p>Hoy he completado el an√°lisis que comenc√© ayer sobre c√≥mo detectar la persistencia de un adversario en nuestros sistemas, espec√≠ficamente cuando se crean varias cuentas de usuarios sospechosas.</p>
  <p><strong>Complementando con lo visto anteriormente:</strong></p>
  <ul>
    <li>Realic√© un an√°lisis detallado de los eventos de creaci√≥n de cuentas, identificando las cuentas creadas, el momento y los sistemas involucrados.</li>
  </ul>
  <p><strong>B√∫squeda de Eventos Adicionales:</strong></p>
  <ul>
    <li>Ampli√© la b√∫squeda para incluir otros eventos de seguridad (como 4738 y 4732) que podr√≠an indicar actividades sospechosas relacionadas con las cuentas de usuario.</li>
  </ul>
  <p>Para m√°s detalles, puedes consultar el an√°lisis completo en el siguiente enlace: An√°lisis Completo</p>
</details>


<details>
  <summary><strong>D√≠a 39: Cazando un APT - Exfiltraci√≥n DNS</strong></summary>
  <p>Continuando con la serie "Cazando un APT", hoy analic√© una posible exfiltraci√≥n de datos utilizando el protocolo DNS.</p>
  <p><strong>Investigaci√≥n de la Exfiltraci√≥n de Datos a trav√©s de DNS:</strong></p>
  <ul>
    <li>Utilic√© la fuente de datos <code>index=botsv2 sourcetype=stream:dns</code> para buscar eventos relacionados con la direcci√≥n IP **160.153.91.7**.</li>
    <li>Identifiqu√© que varios eventos est√°n asociados con el dominio **hildegardsfarm.com**.</li>
  </ul>
  <p><strong>B√∫squeda m√°s espec√≠fica para este dominio:</strong></p>
  <ul>
    <li>Realic√© la b√∫squeda usando <code>index="botsv2" sourcetype="stream:dns" hildegardsfarm.com</code>.</li>
    <li>Enfatizo en los mensajes de tipo **QUERY**, ya que estos son los utilizados por los hosts internos para enviar datos embebidos en las consultas DNS a los adversarios.</li>
  </ul>
  <p><strong>URL Toolbox:</strong></p>
  <ul>
    <li>Descompuse las consultas DNS en subdominios, dominios de nivel superior, y otros componentes utilizando la herramienta URL Toolbox.</li>
    <li>Calcul√© la entrop√≠a de los subdominios para determinar si son generados autom√°ticamente.</li>
  </ul>
  <p><strong>Consulta utilizada:</strong></p>
  <pre><code>index="botsv2" sourcetype="stream:dns" hildegardsfarm.com message_type=QUERY query=*.hildegardsfarm.com
| eval query=mvdedup(query)
| eval list="mozilla"
| ut_parse_extended(query,list)
| ut_shannon(ut_subdomain)
| table src dest query ut_subdomain ut_shannon</code></pre>
  <p>Los subdominios generados tienen un puntaje de entrop√≠a alto, lo que sugiere que son generados autom√°ticamente por un algoritmo. Los datos parecen ser exfiltrados mediante consultas DNS, utilizando subdominios generados autom√°ticamente, que embeben la informaci√≥n en las consultas.</p>
</details>

<details>
  <summary><strong>D√≠a 40: Cazando un APT - Exfiltraci√≥n DNS II</strong></summary>
  <p>Hoy realic√© la segunda parte de la detecci√≥n y prevenci√≥n de la exfiltraci√≥n de datos a trav√©s del protocolo DNS.</p>
  <p><strong>Resumen de los pasos seguidos en la pr√°ctica:</strong></p>
  <ul>
    <li>Consult√© la fuente de datos <code>stream:dns</code> para monitorear eventos DNS relacionados con **hildegardsfarm.com**.</li>
    <li>Observ√© consultas inusuales y de alto volumen a subdominios de **hildegardsfarm.com**, indicativos de posible exfiltraci√≥n de datos.</li>
    <li>Emple√© la URL Toolbox para analizar los subdominios, destacando puntajes de entrop√≠a altos, sugiriendo generaci√≥n autom√°tica por algoritmos.</li>
    <li>Visualic√© la exfiltraci√≥n de datos a trav√©s de DNS, notando la necesidad de dividir paquetes para evitar restricciones de firewall.</li>
  </ul>
  <p><strong>Una vez detectada la exfiltraci√≥n, los pasos a seguir ser√≠an:</strong></p>
  <ul>
    <li>Agregar la IP **160.153.91.7** y el dominio **hildegardsfarm.com** a la lista de observaci√≥n o bloqueo.</li>
    <li>Mantener un monitoreo constante de la entrop√≠a y longitud de subdominios en el tr√°fico DNS.</li>
    <li>Realizar an√°lisis de tr√°fico en los sistemas para identificar y detectar anomal√≠as.</li>
  </ul>
  <p>Puedes ver la pr√°ctica completa en el workspace: An√°lisis Completo</p>
</details>

<details>
  <summary><strong>Day 41: Hunting an APT - Lateral Movement</strong></summary>
  <p>Hoy he empezado un nuevo cap√≠tulo en mi fase de Hunting an APT. Me he dedicado a la identificaci√≥n y an√°lisis de posibles movimientos laterales en la red utilizando Windows Management Instrumentation (WMI). He aprendido que los adversarios pueden utilizar WMI para interactuar con sistemas locales y remotos, ejecutando archivos de forma remota y realizando funciones t√°cticas.</p>
  <p><strong>B√∫squeda en Splunk:</strong></p>
  <ul>
    <li>Desarroll√© una b√∫squeda en Splunk enfocada en eventos clave: 4624 (inicio de sesi√≥n exitoso en red) y 1 de Sysmon (creaci√≥n de procesos).</li>
    <li>Exclu√≠ eventos con svchost.exe como proceso padre para reducir el ruido en los datos.</li>
    <li>Utilizando comandos de Splunk, extraje y evalu√© los campos Logon_ID y Security_ID.</li>
    <li>Cre√© transacciones basadas en el campo session para agrupar eventos relacionados.</li>
  </ul>
  <p><strong>Resultados:</strong></p>
  <p>Los resultados muestran que la estaci√≥n de trabajo wrf-klagerf y el servidor venus presentan signos de ejecuci√≥n utilizando la cuenta service3 desde sesiones de inicio de sesi√≥n en la red, sugiriendo posibles movimientos laterales mediante WMI.</p>
  <p><strong>Referencia:</strong></p>
  <p>Para m√°s informaci√≥n sobre esta t√©cnica de ataque, puedes consultar la <a href="https://attack.mitre.org/techniques/T1047/">p√°gina de MITRE ATT&CK</a>.</p>
</details>

<details>
  <summary><strong>Day 42: Hunting an APT - Lateral Movement II</strong></summary>
  <p>Continuando con el m√≥dulo de ayer, he profundizado en c√≥mo los adversarios pueden aprovechar WMI (Windows Management Instrumentation) para interactuar con sistemas locales y remotos, permiti√©ndoles ejecutar archivos de forma remota y realizar diversas funciones t√°cticas.</p>
  <p>Para finalizar, he estado dedicado a la inspecci√≥n detallada de sesiones de inicio de sesi√≥n en nuestra red. Mi enfoque ha sido utilizar los IDs de inicio de sesi√≥n, ya sea el Logon_ID de Sysmon o el LogonId de Wineventlog.</p>
  <p>Los an√°lisis realizados hoy indican que los hosts internos "venus" y "wrk-klagers" han sido infectados mediante movimiento lateral desde "wrk-btun". El uso de PowerShell parece ser una herramienta clave utilizada por el adversario para facilitar este movimiento.</p>
  <p><strong>Conclusiones:</strong></p>
  <ul>
    <li>Configurar alertas para PowerShell codificado.</li>
    <li>Gestionar herramientas de administraci√≥n remota de Windows.</li>
    <li>Monitorizar el uso de herramientas administrativas.</li>
    <li>Establecer alertas para secuencias espec√≠ficas de eventos.</li>
    <li>Analizar los flujos de datos en el entorno.</li>
  </ul>
  <p>Puedes revisar la pr√°ctica en detalle en el <a href="https://nottaroff.github.io/workspace/docs/Hunting%20an%20APT/5.%20Lateral%20Movement/">workspace de Notaroff</a>.</p>
</details>

<details>
  <summary><strong>Day 43: Hunting an APT - Borrado de Registros</strong></summary>
  <p>Siguiendo en la investigaci√≥n de diferentes t√°cticas que usan los adversarios, hoy me enfoqu√© en investigar una t√°ctica com√∫nmente utilizada por los adversarios para cubrir sus huellas, el borrado de registros de eventos de Windows.</p>
  <p>En primera instancia, identifiqu√© los eventos de borrado de registros en Windows utilizando el c√≥digo de evento 1102. Al buscar en los registros de eventos de Windows, vi que la estaci√≥n de trabajo wrk-klagerf tuvo sus registros borrados y que la cuenta service3 fue responsable de esta acci√≥n.</p>
  <p>Analic√© el uso del comando wevtutil.exe, que permite interactuar con los registros de eventos desde la l√≠nea de comandos. Encontramos referencias a este ejecutable tanto en Sysmon como en Wineventlog, lo que sugiere un uso continuado de este comando para borrar registros. Al profundizar en los registros de eventos de Windows y ordenar los eventos, observamos que wevtutil.exe se us√≥ repetidamente con los argumentos "el" (para enumerar los registros) y "cl" (para borrar registros espec√≠ficos).</p>
  <p>Este an√°lisis revel√≥ 485 eventos, indicando que probablemente se borraron todos los registros de Windows posibles en secuencia.</p>
</details>


<details>
  <summary><strong>Day 44: Hunting an APT - Borrado de Registros II</strong></summary>
  <p>Para finalizar este cap√≠tulo sobre la caza de borrado de registros, realic√© un an√°lisis detallado de los eventos registrados por Sysmon, centr√°ndome en detectar actividades de borrado de registros. En la revisi√≥n, encontramos que wevtutil.exe se utiliz√≥ repetidamente para borrar registros, lo cual es una t√°ctica com√∫n para ocultar actividades maliciosas.</p>
  <p>He estado recopilando consejos pr√°cticos para fortalecer la seguridad frente al borrado de registros. Por ejemplo, se recomienda configurar pol√≠ticas de grupo para registrar borrados, monitorear y alertar sobre el evento 1102, y el evento 4688 con l√≠neas de comando espec√≠ficas relacionadas con wevtutil.exe. Tambi√©n es importante revisar y actualizar las pol√≠ticas de los sistemas para proteger los registros cr√≠ticos que no deben ser eliminados.</p>
  <p>Puedes ver en detalle la pr√°ctica en el <a href="https://nottaroff.github.io/workspace/docs/Hunting%20an%20APT/6.%20Clearing%20Logs/">workspace de Notaroff</a>.</p>
</details>

<details>
  <summary><strong>Day 45: Hunting an APT - Remote Data Staging</strong></summary>
  <p>En un nuevo cap√≠tulo en la serie de Hunting an APT, hoy he observado posibles actividades relacionadas con la organizaci√≥n y exfiltraci√≥n de datos en nuestra red.</p>
  <p>En particular, he investigado los archivos que se usar√≠an en un entorno de oficina, como documentos PDF, Word, Excel y archivos comprimidos. Esto me llev√≥ a observar detenidamente el protocolo SMB (Server Message Block) utilizado para compartir archivos en entornos de red, especialmente en entornos Windows.</p>
  <p>Mi investigaci√≥n se centr√≥ en un archivo espec√≠fico identificado como "31564-pdf.pdf" dentro del conjunto de datos SMB. Analic√© las transacciones relacionadas con este archivo, observando patrones de flujo de datos y comandos utilizados. En particular, me enfoqu√© en comandos como "smb2 read", "smb2 create" y "smb2 close", los cuales revelaron c√≥mo se estaban manipulando y transfiriendo los datos en cuesti√≥n.</p>
  <p>He conseguido identificar una actividad significativa de transferencia de datos entre la estaci√≥n de trabajo de Billy Tun y el servidor Venus. Observ√© que una cantidad considerable de datos estaba siendo transferida desde el servidor hacia la estaci√≥n de trabajo, lo cual podr√≠a ser un posible movimiento de informaci√≥n desde el servidor hacia un dispositivo local.</p>
  <p>Para obtener m√°s informaci√≥n sobre esta t√©cnica de ataque, puedes consultar la <a href="https://attack.mitre.org/techniques/T1074/">p√°gina de MITRE ATT&CK</a>.</p>
</details>

<details>
  <summary><strong>Day 46: Hunting an APT - Remote Data Staging II</strong></summary>
  <p>Siguiendo con la sesi√≥n anterior sobre la exfiltraci√≥n de datos de nuestra red, hoy investigu√© el conjunto de datos relacionados con FTP, detectando actividades sospechosas que sugieren una posible exfiltraci√≥n de datos. Por ejemplo, la estaci√≥n de trabajo de Billy (IP: 10.0.2.107) subi√≥ un archivo PDF a un servidor externo (IP: 160.153.91.7), lo que indica un posible caso de exfiltraci√≥n a trav√©s de FTP.</p>
  <p>Adem√°s, al analizar los datos de SMB, observ√© que varios documentos, principalmente archivos PDF, se transfirieron desde un servidor interno (IP: 10.0.1.101) a la estaci√≥n de trabajo de Billy, y luego se enviaron al servidor externo mencionado.</p>
  <p>Para mejorar nuestras capacidades de detecci√≥n y prevenci√≥n, se deben considerar las siguientes acciones:</p>
  <ul>
    <li>Realizar un an√°lisis de anomal√≠as en la comunicaci√≥n entre la estaci√≥n de trabajo y el servidor.</li>
    <li>Registrar los puntos finales para monitorear los datos escritos en el sistema de archivos.</li>
    <li>Mejorar el registro de la red para capturar transferencias de datos entre enclaves.</li>
    <li>Buscar actividades posteriores, como transferencias de archivos a direcciones externas o escrituras a dispositivos USB.</li>
  </ul>
  <p>Puedes encontrar la pr√°ctica completa en el <a href="https://nottaroff.github.io/workspace/docs/Hunting%20an%20APT/7.%20Data%20Staging/">workspace de Notaroff</a>.</p>
</details>

<details>
  <summary><strong>Day 47: Hunting an APT - Reconnaissance</strong></summary>
  <p>En el cap√≠tulo de hoy me enfoqu√© en la caza de reconocimiento, buscando identificar posibles adversarios que podr√≠an haber sido descuidados en sus m√©todos.</p>
  <p>Encontr√© detalles espec√≠ficos relacionados con un posible ataque que ocurri√≥ en agosto de 2017, afectando al sitio web de la empresa ejemplo, www.froth.ly. Al examinar cadenas de agente de usuario sospechosas, identifiqu√© una en particular que se destac√≥: Mozilla/5.0 (X11; U; Linux i686; ko-KP; rv: 19.1br) Gecko/20130508 Fedora/1.9.1-2.5.rs3.0 NaenaraBrowser/3.5b4. Este navegador, Naenara, es la versi√≥n de Firefox utilizada en la Rep√∫blica Popular Democr√°tica de Corea (RPDC), e integrada en el sistema operativo Red Star, el cual es el sistema oficial de Corea del Norte.</p>
  <p>Haciendo la b√∫squeda en Splunk, pude identificar 2 IPs internas y 3 IPs externas. Al cruzar la informaci√≥n de activos con las IPs internas, descubr√≠ que una de ellas (172.31.4.249) pertenec√≠a a Kevin Lagerfield, con el nombre de host "gacrux". Kevin ha accedido a varios sistemas, incluyendo AWS, brewertalk, linux, mysql y web. La otra IP interna (172.31.6.251) no se encontraba en la hoja de activos, pero parece ser que era la IP de nuestro sitio web corporativo.</p>
</details>

<details>
  <summary><strong>Day 48: Hunting an APT - Reconnaissance II</strong></summary>
  <p>En la segunda parte del ejercicio de reconocimiento, hoy he trabajado en el an√°lisis de la visibilidad p√∫blica de nuestra web corporativa, centr√°ndome en c√≥mo los adversarios pueden recopilar informaci√≥n sobre nosotros antes de un ataque. Esto se basa en la t√©cnica del MITRE ATT&CK T1593, que se enfoca en la b√∫squeda de sitios web y dominios abiertos.</p>
  <p>Utilic√© Splunk para buscar accesos a nuestro sitio web de ejemplo mediante un agente de usuario espec√≠fico (NaenaraBrowser), que hab√≠amos identificado previamente como sospechoso. Confirm√© que este agente de usuario ha estado navegando por nuestros activos web y accediendo a una hoja de c√°lculo con contactos de la empresa. Identificamos que este navegador tiene origen en Corea del Norte. Encontramos la direcci√≥n IP asociada con el navegador, que accedi√≥ a los contactos de la empresa desde nuestro sitio web. Esto podr√≠a permitir al adversario tener acceso a informaci√≥n sensible y potencialmente dirigir ataques a nuestros empleados.</p>
  <p>Como siguientes pasos se ha concluido que debemos entender la visibilidad p√∫blica de la organizaci√≥n y monitorear a los ejecutivos clave que son bien conocidos. Es necesario determinar si todos los empleados necesitan el mismo nivel de visibilidad y monitorear si su informaci√≥n aparece p√∫blicamente. Debemos prestar especial atenci√≥n a nuestro sitio web y otros activos corporativos, minimizando la informaci√≥n OSINT disponible sobre empleados y activos inform√°ticos. Adem√°s, podemos sembrar objetos con informaci√≥n err√≥nea en la organizaci√≥n, incluyendo el sitio web, que luego puedan ser monitoreados para detectar actividad adversaria y hacer que los atacantes inviertan m√°s esfuerzo en sus intentos.</p>
</details>


<details>
  <summary><strong>Day 49: Hunting an APT - Initial Access</strong></summary>
  <p>En el ejercicio de hoy vi una ataque a nuestra red, identificando los vectores de acceso inicial. Durante esta investigaci√≥n, identificamos que el acceso inicial se logr√≥ mediante un archivo adjunto en un correo electr√≥nico de spear phishing. Realic√© an√°lisis detallados de los archivos adjuntos y en los registros de correo electr√≥nico. Descubrimos que el intento de phishing se llev√≥ a cabo dos veces, con el segundo intento posiblemente siendo exitoso.</p>
  <p>Finalmente, encontramos que el mismo remitente envi√≥ correos electr√≥nicos id√©nticos a cuatro destinatarios. Estos correos ten√≠an el mismo asunto y contenido, lo que sugiere una estrategia de ataque dirigida espec√≠ficamente a estos destinatarios. Adem√°s, observamos que los correos electr√≥nicos se enviaron en un corto intervalo de tiempo, pero de manera individual, lo que podr√≠a indicar un intento de evitar la detecci√≥n.</p>
  <p>En conclusi√≥n, parece que nuestra empresa fue probablemente v√≠ctima de phishing a trav√©s de un archivo adjunto en un correo electr√≥nico. Ambos intentos de phishing estuvieron dirigidos a los mismos destinatarios, con el mismo remitente, asunto y contenido en ambos casos. Aunque el primer intento fue detectado como un troyano, el segundo intento no gener√≥ ninguna alerta, lo que sugiere que podr√≠a haber sido exitoso.</p>
</details> 


<details>
  <summary><strong>Day 50: Threat hunting para amenazas internas</strong></summary>
  <p>Despu√©s de terminar los ejercicios de Threat hunting (Hunting an APT) de Splunk Boss of the SOC, decid√≠ continuar con el guion que hab√≠a planteado desde el primer momento para acabar los puntos te√≥ricos que me faltan.</p>
  <p>As√≠ que el d√≠a de hoy he estado estudiando la identificaci√≥n y mitigaci√≥n de amenazas internas. Principalmente tres tipos de amenazas internas: las provenientes de personas malintencionadas, negligentes y comprometidas.</p>
  <ul>
    <li>Las personas malintencionadas: Buscan da√±ar la organizaci√≥n por venganza o beneficio econ√≥mico. Un punto de mitigaci√≥n a ello ser√≠a implementar gesti√≥n de acceso y monitorizaci√≥n continua de cuentas inactivas.</li>
    <li>Las personas internas negligentes: Representan un riesgo debido a su falta de conocimiento o descuido en seguridad. Para mitigarlo se podr√≠a aplicar una capacitaci√≥n continua y la implementaci√≥n de pol√≠ticas claras sobre el manejo de datos sensibles.</li>
    <li>Las personas internas comprometidas: Son usuarios leg√≠timos cuyas credenciales han sido comprometidas por atacantes externos. Para mitigar esto se podr√≠a implementar una autenticaci√≥n multifactor y el monitoreo de comportamientos an√≥malos como estrategias clave.</li>
  </ul>
  <p>Tambi√©n he visto algunos de los indicadores clave para su detecci√≥n, como el acceso no autorizado y cambios en el comportamiento del usuario. Para reforzar la postura de seguridad, se puede implementar diversas estrategias: como la creaci√≥n y comunicaci√≥n de pol√≠ticas claras, el control de acceso basado en el principio de m√≠nimo privilegio, la autenticaci√≥n multifactor y la capacitaci√≥n regular del personal. Tambi√©n es importante un monitoreo continuo de la actividad del usuario y la red, junto con simulaciones de ataques para identificar y corregir vulnerabilidades.</p>
</details>

<details>
  <summary><strong>Day 51: Threat hunting an APT</strong></summary>
  <p>Al terminar los apartados pr√°cticos de Hunting an APT, he querido realizar un peque√±o apartado sobre los conceptos que he recopilado.</p>
  <p>He podido destacar que las APT se dirigen a organizaciones espec√≠ficas con objetivos claros como el robo de propiedad intelectual y el espionaje, operando durante largos periodos y utilizando t√©cnicas avanzadas. Estas amenazas emplean m√©todos de sigilo y evasi√≥n, como cifrado de comunicaciones y el uso de herramientas leg√≠timas del sistema, y sus fines suelen estar relacionados con el espionaje y la perturbaci√≥n de operaciones cr√≠ticas.</p>
  <p>Para el hunting de APTs, he visto que es fundamental conocer sus T√°cticas, T√©cnicas y Procedimientos (TTPs). Las t√°cticas incluyen estrategias generales como la persistencia y el movimiento lateral; las t√©cnicas abarcan m√©todos espec√≠ficos como la explotaci√≥n de vulnerabilidades y el phishing; y los procedimientos detallan la implementaci√≥n de estas t√©cnicas.</p>
  <p>Al finalizar las conclusiones es importante destacar la evoluci√≥n constante de los APTs y la necesidad de adelantarse a las amenazas mediante la inteligencia de fuentes abiertas OSINT y plataformas de inteligencia de amenazas. Estas herramientas enriquecen los indicadores de compromiso con informaci√≥n contextual y facilitan la colaboraci√≥n entre profesionales de la seguridad.</p>
</details>

<details>
  <summary><strong>Day 52: Threat hunting in cloud</strong></summary>
  <p>En el d√≠a de hoy he recopilado informaci√≥n sobre los desaf√≠os y t√©cnicas de seguridad en entornos de nube.</p>
  <p>Los principales desaf√≠os de seguridad que enfrentamos al adoptar servicios en la nube incluyen la dificultad para mantener visibilidad y control debido a la naturaleza din√°mica de estos entornos, los riesgos adicionales derivados del alojamiento de datos de m√∫ltiples clientes en la misma infraestructura y las vulnerabilidades causadas por configuraciones predeterminadas o incorrectas. Tambi√©n existe confusi√≥n sobre la divisi√≥n de responsabilidades entre el proveedor y el cliente, lo que puede llevar a malentendidos sobre qui√©n es responsable de qu√© aspectos de la seguridad.</p>
  <p>En cuanto a las t√©cnicas espec√≠ficas para cazar amenazas en la nube, es importante analizar logs de eventos y accesos proporcionados por los proveedores de servicios en la nube, como AWS CloudTrail y Azure Monitor, para detectar comportamientos inusuales. Tambi√©n es esencial utilizar herramientas nativas de seguridad, como AWS GuardDuty y Azure Security Center, y monitorear el tr√°fico de red.</p>
  <p>Para asegurar las cargas de trabajo en la nube es necesario integrar pr√°cticas de seguridad desde el inicio del ciclo de desarrollo (DevSecOps), implementar pol√≠ticas estrictas de gesti√≥n de identidades y accesos (IAM) para asegurar que solo las personas y servicios autorizados puedan acceder a los recursos cr√≠ticos, y asegurando que todos los datos, tanto en tr√°nsito como en reposo, est√©n cifrados y que las claves se gestionen de manera segura.</p>
</details>


<details>
  <summary><strong>Day 53: Threat hunting in cloud - Privilege Escalation via AWS Lambda</strong></summary>
  <p>Ayer vi una peque√±a introducci√≥n al Threat hunting en la nube. Hoy quer√≠a ver un poco la parte pr√°ctica. As√≠ que hice un taller de un ataque en la nube que involucr√≥ a un hacker que obtuvo credenciales de un usuario de AWS con bajos privilegios y sin acceso a S3. El atacante utiliz√≥ estas credenciales para ejecutar el comando list-functions en diferentes regiones y encontrar funciones Lambda accesibles.</p>
  <p>El hacker descubri√≥ una funci√≥n Lambda con runtime en Python y, en su propia cuenta de AWS, cre√≥ una capa comprometida con una puerta trasera, haci√©ndola p√∫blica. Luego, us√≥ el usuario de bajos privilegios en la cuenta de la v√≠ctima para actualizar la configuraci√≥n de la funci√≥n Lambda e insertar la capa comprometida.</p>
  <p>Esta capa comprometida conten√≠a una carga √∫til que enviaba datos cr√≠ticos y sensibles a la m√°quina del atacante cuando se invocaba la funci√≥n Lambda. El atacante configur√≥ una m√°quina de escucha con una IP p√∫blica, esperando en el puerto 4444 para recibir estos datos. Al llamar la funci√≥n Lambda, el hacker recib√≠a informaci√≥n como el ID de clave de acceso, la clave de acceso secreta y el token de sesi√≥n, permiti√©ndole ejecutar el comando aws s3 ls para encontrar y exfiltrar datos sensibles.</p>
  <p>Para investigar el ataque, el taller utiliza la herramienta CloudGuard, donde se puede extraer la siguiente informaci√≥n:</p>
  <ul>
    <li>Abuso del Token de Acceso de Lambda: Uso indebido del token desde una IP externa.</li>
    <li>Serie de Llamadas API de Enumeraci√≥n: Detect√≥ la ejecuci√≥n de list-functions en varias regiones, indicando un intento de movimiento lateral y escalada de privilegios.</li>
    <li>Adici√≥n de una Capa de Lambda desde una Cuenta Externa: Inserci√≥n de una capa desde una cuenta de AWS externa.</li>
    <li>Actualizaci√≥n de Configuraci√≥n de Lambda: Esto puede ayudar a entender c√≥mo el atacante exfiltr√≥ las credenciales sensibles.</li>
  </ul>
</details>

<details>
  <summary><strong>Day 54: Threat hunting in cloud - Lateral Movement</strong></summary>
  <p>Hoy observ√© un nuevo ejemplo de caza de amenazas en un entorno de nube, espec√≠ficamente la detecci√≥n de movimiento lateral. El ataque comenz√≥ con la obtenci√≥n de claves de acceso de AWS comprometidas, que permitieron al atacante generar credenciales temporales usando el comando get-session-token para evadir la defensa. Verificaron el acceso al historial de eventos de la cuenta mediante el comando lookup-events, confirmando que el usuario comprometido ten√≠a permisos de solo lectura. Esto les permiti√≥ descubrir que el usuario hab√≠a ejecutado el comando AssumeRole para asumir el rol LambdaCreator, obteniendo informaci√≥n clave como la regi√≥n por defecto y el ARN del rol.</p>
  <p>El atacante verific√≥ los eventos realizados por el rol LambdaCreator y encontr√≥ que se hab√≠a configurado y actualizado el c√≥digo de una funci√≥n llamada Automation-UpdateSSMParam. Utilizando el comando sts assume role, escal√≥ privilegios al rol LambdaCreator. Intentaron el comando get-function pero recibieron un error de acceso denegado. Entonces recurrieron a la ingenier√≠a social, descubriendo mediante una b√∫squeda en Google que el rol asociado a la funci√≥n ten√≠a permisos de AmazonSSMFullAccess. Aprovechando el permiso UpdateFunctionConfiguration, inyectaron una capa maliciosa en la funci√≥n, creando esta capa en su propia cuenta de AWS y haci√©ndola p√∫blicamente disponible.</p>
  <p>El atacante insert√≥ la capa maliciosa en la cuenta de la v√≠ctima usando el comando UpdateFunctionConfiguration. Una vez invocada la funci√≥n, la capa maliciosa envi√≥ todas las variables de entorno, incluyendo el token STS del rol de la funci√≥n, al atacante. Con este token, iniciaron una sesi√≥n en una instancia EC2 usando el API SSM start session y extrajeron el nombre del rol de la instancia: DynamoDBFullAccess. Accedieron a las tablas de DynamoDB, revelando informaci√≥n sensible.</p>
</details>